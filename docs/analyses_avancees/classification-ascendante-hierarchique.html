<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>guide-R - 41&nbsp; Classification ascendante hiérarchique</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../analyses_avancees/analyse-survie.html" rel="next">
<link href="../analyses_avancees/analyse-factorielle.html" rel="prev">
<link href="../ressources/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "Rechercher",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-8BT7D9P85Y"></script><script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-8BT7D9P85Y', { 'anonymize_ip': true});
</script><script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"fr"
  });
});
</script><style>html{ scroll-behavior: smooth; }</style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../analyses_avancees/analyse-factorielle.html"><strong>Analyses avancées</strong></a></li><li class="breadcrumb-item"><a href="../analyses_avancees/classification-ascendante-hierarchique.html"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Classification ascendante hiérarchique</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../ressources/typewriter.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">guide-R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/larmarange/guide-R/" title="Code source" class="quarto-navigation-tool px-1" aria-label="Code source"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Basculer le mode sombre"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Préface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text"><strong>Bases du langage</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bases/packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bases/vecteurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Vecteurs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bases/listes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Listes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bases/tableaux_donnees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tableaux de données</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bases/tibbles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tibbles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bases/attributs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Attributs</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text"><strong>Manipulation de données</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/pipe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Le pipe</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/facteurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Facteurs et <code>forcats</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/combiner-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Combiner plusieurs variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/etiquettes-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Étiquettes de variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/etiquettes-valeurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Étiquettes de valeurs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/valeurs-manquantes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Valeurs manquantes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/import-export.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Import &amp; Export de données</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/formater-nombre.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Mettre en forme des nombres</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/couleurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Couleurs &amp; Palettes</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text"><strong>Analyses</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Graphiques avec <code>ggplot2</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/statistique-univariee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Statistique univariée &amp; Intervalles de confiance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/statistique-bivariee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Statistique bivariée &amp; Tests de comparaison</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/likert.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Échelles de Likert</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/regression-lineaire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Régression linéaire</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/regression-logistique-binaire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Régression logistique binaire</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/selection-modele-pas-a-pas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Sélection pas à pas d’un modèle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/estimations-marginales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Prédictions marginales, contrastes marginaux &amp; effets marginaux</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/contrastes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Contrastes (variables catégorielles)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Interactions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/multicolinearite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Multicolinéarité</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text"><strong>Données pondérées avec <code>survey</code></strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../donnees_ponderees/plan-echantillonnage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Définir un plan d’échantillonnage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../donnees_ponderees/manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Manipulation de données pondérées</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../donnees_ponderees/analyses-bivariees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Analyses uni- et bivariées pondérées</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../donnees_ponderees/graphiques-ponderes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Graphiques pondérés</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../donnees_ponderees/regression-logistique-binaire-ponderee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Régression logistique binaire pondérée</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text"><strong>Manipulation avancée</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation_avancee/fusion-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Fusion de tables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation_avancee/dates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Dates avec <code>lubridate</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation_avancee/stringr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Chaînes de texte avec <code>stringr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation_avancee/tidyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Réorganisation avec <code>tidyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation_avancee/conditions-logiques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Conditions logiques</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation_avancee/fonctions-a-fenetre.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Fonctions à fenêtre</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation_avancee/transformations-multiples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Transformations multiples</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text"><strong>Analyses avancées</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/analyse-factorielle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Analyse factorielle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/classification-ascendante-hierarchique.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Classification ascendante hiérarchique</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/analyse-survie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Analyse de survie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/regression-logistique-multinomiale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Régression logistique multinomiale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/regression-logistique-ordinale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Régression logistique ordinale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/modeles-comptage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Modèles de comptage (Poisson &amp; apparentés)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/modeles-incidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modèles d’incidence / de taux</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/modeles-zero-inflated.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Modèles de comptage <em>zero-inflated</em> et <em>hurdle</em></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/choix-modele.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Quel modèle choisir&nbsp;?</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text"><strong>Pour aller plus loin</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../extra/ressources-documentaires.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Ressources documentaires</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table des matières</h2>
   
  <ul>
<li>
<a href="#calculer-une-matrice-des-distances" id="toc-calculer-une-matrice-des-distances" class="nav-link active" data-scroll-target="#calculer-une-matrice-des-distances"><span class="header-section-number">41.1</span> Calculer une matrice des distances</a>
  <ul class="collapse">
<li><a href="#distance-de-gower" id="toc-distance-de-gower" class="nav-link" data-scroll-target="#distance-de-gower"><span class="header-section-number">41.1.1</span> Distance de Gower</a></li>
  <li><a href="#distance-du-%CF%86%C2%B2" id="toc-distance-du-φ²" class="nav-link" data-scroll-target="#distance-du-%CF%86%C2%B2"><span class="header-section-number">41.1.2</span> Distance du Φ²</a></li>
  <li><a href="#illustration" id="toc-illustration" class="nav-link" data-scroll-target="#illustration"><span class="header-section-number">41.1.3</span> Illustration</a></li>
  </ul>
</li>
  <li>
<a href="#calcul-du-dendrogramme" id="toc-calcul-du-dendrogramme" class="nav-link" data-scroll-target="#calcul-du-dendrogramme"><span class="header-section-number">41.2</span> Calcul du dendrogramme</a>
  <ul class="collapse">
<li><a href="#repr%C3%A9sentation-graphique-du-dendrogramme" id="toc-représentation-graphique-du-dendrogramme" class="nav-link" data-scroll-target="#repr%C3%A9sentation-graphique-du-dendrogramme"><span class="header-section-number">41.2.1</span> Représentation graphique du dendrogramme</a></li>
  </ul>
</li>
  <li>
<a href="#d%C3%A9couper-le-dendrogramme" id="toc-découper-le-dendrogramme" class="nav-link" data-scroll-target="#d%C3%A9couper-le-dendrogramme"><span class="header-section-number">41.3</span> Découper le dendrogramme</a>
  <ul class="collapse">
<li><a href="#classes-obtenues-avec-la-distance-de-gower" id="toc-classes-obtenues-avec-la-distance-de-gower" class="nav-link" data-scroll-target="#classes-obtenues-avec-la-distance-de-gower"><span class="header-section-number">41.3.1</span> Classes obtenues avec la distance de Gower</a></li>
  <li><a href="#classes-obtenues-%C3%A0-partir-de-lacm-distance-du-%CF%86%C2%B2" id="toc-classes-obtenues-à-partir-de-lacm-distance-du-φ²" class="nav-link" data-scroll-target="#classes-obtenues-%C3%A0-partir-de-lacm-distance-du-%CF%86%C2%B2"><span class="header-section-number">41.3.2</span> Classes obtenues à partir de l’ACM (distance du Φ²)</a></li>
  </ul>
</li>
  <li><a href="#calcul-de-lacm-et-de-la-cah-avec-factominer" id="toc-calcul-de-lacm-et-de-la-cah-avec-factominer" class="nav-link" data-scroll-target="#calcul-de-lacm-et-de-la-cah-avec-factominer"><span class="header-section-number">41.4</span> Calcul de l’ACM et de la CAH avec <code>FactoMineR</code></a></li>
  <li><a href="#caract%C3%A9riser-la-typologie" id="toc-caractériser-la-typologie" class="nav-link" data-scroll-target="#caract%C3%A9riser-la-typologie"><span class="header-section-number">41.5</span> Caractériser la typologie</a></li>
  <li><a href="#webin-r" id="toc-webin-r" class="nav-link" data-scroll-target="#webin-r"><span class="header-section-number">41.6</span> webin-R</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/larmarange/guide-R/blob/main/analyses_avancees/classification-ascendante-hierarchique.qmd" class="toc-action"><i class="bi bi-github"></i>Voir la source</a></li><li><a href="https://github.com/larmarange/guide-R/issues/new" class="toc-action"><i class="bi empty"></i>Faire part d'un problème</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../analyses_avancees/analyse-factorielle.html"><strong>Analyses avancées</strong></a></li><li class="breadcrumb-item"><a href="../analyses_avancees/classification-ascendante-hierarchique.html"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Classification ascendante hiérarchique</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-classification-ascendante-hierarchique" class="quarto-section-identifier"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Classification ascendante hiérarchique</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Il existe de nombreuses techniques statistiques visant à partinionner une population en différentes classes ou sous-groupes. La <em>classification ascendante hiérarchique</em> (CAH) est l’une d’entre elles. On cherche à ce que les individus regroupés au sein d’une même classe (homogénéité intra-classe) soient le plus semblables possibles tandis que les classes soient le plus dissemblables (hétérogénéité inter-classe).</p>
<p>Le principe de la CAH est de rassembler des individus selon un critère de ressemblance défini au préalable qui s’exprimera sous la forme d’une matrice de distances, exprimant la distance existant entre chaque individu pris deux à deux. Deux observations identiques auront une distance nulle. Plus les deux observations seront dissemblables, plus la distance sera importante. La CAH va ensuite rassembler les individus de manière itérative afin de produire un dendrogramme ou arbre de classification. La classification est <em>ascendante</em> car elle part des observations individuelles&nbsp;; elle est <em>hiérarchique</em> car elle produit des classes ou groupes de plus en plus vastes, incluant des sous-groupes en leur sein. En découpant cet arbre à une certaine hauteur choisie, on produira la partition désirée.</p>
<section id="calculer-une-matrice-des-distances" class="level2 page-columns page-full" data-number="41.1"><h2 data-number="41.1" class="anchored" data-anchor-id="calculer-une-matrice-des-distances">
<span class="header-section-number">41.1</span> Calculer une matrice des distances</h2>
<p>La notion de ressemblance entre observations est évaluée par une distance entre individus. Plusieurs type de distances existent selon les données utilisées.</p>
<p>Il existe de nombreuses distances mathématiques pour les variables quantitatives (euclidiennes, Manhattan…) que nous n’aborderons pas ici<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. La plupart peuvent être calculées avec la fonction <code><a href="https://rdrr.io/r/stats/dist.html">stats::dist()</a></code>.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Pour une présentation des propriétés mathématiques des distances et des distances les lus courantes, on pourra se référer à la <a href="https://fr.wikipedia.org/wiki/Distance_(math%C3%A9matiques)">page Wikipedia</a> correspondance.</p></div><div id="fn2"><p><sup>2</sup>&nbsp;Cette même fonction peut aussi être utilisée pour calculer une distance après une analyse en composantes principales ou une analyse mixte de Hill et Smith.</p></div></div><p>Usuellement, pour un ensemble de variables qualitatives, on aura recours à la distance du Φ² qui est celle utilisée pour l’analyse des correspondances multiples (cf. <a href="analyse-factorielle.html" class="quarto-xref"><span>Chapitre 40</span></a>). Avec l’extension <a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a>, la distance du Φ² s’obtient avec la fonction <code><a href="https://rdrr.io/pkg/ade4/man/dist.dudi.html">ade4::dist.dudi()</a></code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Le cas particulier de la CAH avec l’extension <a href="http://factominer.free.fr">FactoMineR</a> sera abordée un peu plus loin.</p>
<p>Nous évoquerons également la distance de Gower qui peut s’appliquer à un ensemble de variables à la fois qualitatives et quantitatives et qui se calcule avec la fonction <code><a href="https://rdrr.io/pkg/cluster/man/daisy.html">cluster::daisy()</a></code> de l’extension <a href="https://svn.r-project.org/R-packages/trunk/cluster/">cluster</a>.</p>
<p>Il existe bien entendu d’autres types de distance. Par exemple, dans le chapitre sur l’analyse de séquences, nous verrons comment calculer une distance entre séquences, permettant ainsi de réaliser une classification ascendante hiérarchique.</p>
<section id="distance-de-gower" class="level3 page-columns page-full" data-number="41.1.1"><h3 data-number="41.1.1" class="anchored" data-anchor-id="distance-de-gower">
<span class="header-section-number">41.1.1</span> Distance de Gower</h3>
<p>En 1971, Gower a proposé un indice de similarité qui porte son nom<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. L’objectif de cet indice consiste à mesurer dans quelle mesure deux individus sont semblables. L’indice de Gower varie entre 0 et 1. Si l’indice vaut 1, les deux individus sont identiques. À l’opposé, s’il vaut 0, les deux individus considérés n’ont pas de point commun. Si l’on note <span class="math inline">\(S_g\)</span> l’indice de similarité de Gower, la distance de Gower <span class="math inline">\(D_g\)</span> s’obtient simplement de la manière suivante&nbsp;: <span class="math inline">\(D_g = 1 - S_g\)</span>. Ainsi, la distance sera nulle entre deux individus identiques et elle sera égale à 1 entre deux individus totalement différents. Cette distance s’obtient sous <strong>R</strong> avec la fonction <code><a href="https://rdrr.io/pkg/cluster/man/daisy.html">cluster::daisy()</a></code> du package <a href="https://svn.r-project.org/R-packages/trunk/cluster/">cluster</a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;Voir Gower, J. (1971). A General Coefficient of Similarity and Some of Its Properties. <em>Biometrics</em>, 27(4), 857-871. doi:<a href="https://doi.org/10.2307/2528823">10.2307/2528823</a> (<a href="http://www.jstor.org/stable/2528823" class="uri">http://www.jstor.org/stable/2528823</a>).</p></div></div><p>L’indice de similarité de Gower entre deux individus <em>x<sub>1</sub></em> et <em>x<sub>2</sub></em> se calcule de la manière suivante&nbsp;:</p>
<p><span class="math display">\[
S_{g}(x_{1},x_{2})=\frac{1}{p}\sum_{j=1}^{p}s_{12j}
\]</span></p>
<p><span class="math inline">\(p\)</span> représente le nombre total de caractères (ou de variables) descriptifs utilisés pour comparer les deux individus<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. <span class="math inline">\(s_{ 12j}\)</span> représente la similarité partielle entre les individus 1 et 2 concernant le descripteur <span class="math inline">\(j\)</span>. Cette similarité partielle se calcule différemment s’il s’agit d’une variable qualitative ou quantitative&nbsp;:</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;Pour une description mathématique plus détaillée de cette fonction, notamment en cas de valeur manquante, se référer à l’article original de Gower précédemment cité.</p></div></div><ul>
<li>
<strong>variable qualitative&nbsp;:</strong> <span class="math inline">\(s_{ 12j}\)</span> vaut 1 si la variable <span class="math inline">\(j\)</span> prend la même valeur pour les individus 1 et 2, et vaut 0 sinon. Par exemple, si 1 et 2 sont tous les deux «&nbsp;grand&nbsp;», alors <span class="math inline">\(s_{12j}\)</span> vaudra 1. Si 1 est «&nbsp;grand&nbsp;» et 2 «&nbsp;petit&nbsp;», <span class="math inline">\(s_{12j}\)</span> vaudra 0.</li>
<li>
<strong>variable quantitative&nbsp;:</strong> la différence absolue entre les valeurs des deux variables est tout d’abord calculée, soit <span class="math inline">\(|y_{1j} - y_{2j}|\)</span>. Puis l’écart maximum observé sur l’ensemble du fichier est déterminé et noté <span class="math inline">\(R_j\)</span>. Dès lors, la similarité partielle vaut <span class="math inline">\(s_{12j} = 1 - |y_{1j} - y_{2j}| / R_j\)</span>.</li>
</ul>
<p>Dans le cas où l’on n’a que des variables qualitatives, la valeur de l’indice de Gower correspond à la proportion de caractères en commun. Supposons des individus 1 et 2 décris ainsi&nbsp;:</p>
<ol type="1">
<li>homme / grand / blond / étudiant / urbain</li>
<li>femme / grande / brune / étudiante / rurale</li>
</ol>
<p>Sur les 5 variables utilisées pour les décrire, 1 et 2 ont deux caractéristiques communes&nbsp;: ils sont grand(e)s et étudiant(e)s. Dès lors, l’indice de similarité de Gower entre 1 et 2 vaut 2/5&nbsp;=&nbsp;0,4 (soit une distance de 1&nbsp;−&nbsp;0,4&nbsp;=&nbsp;0,6).</p>
<p>Plusieurs approches peuvent être retenues pour traiter les valeurs manquantes&nbsp;:</p>
<ul>
<li>supprimer tout individu n’étant pas renseigné pour toutes les variables de l’analyse&nbsp;;</li>
<li>considérer les valeurs manquantes comme une modalité en tant que telle&nbsp;;</li>
<li>garder les valeurs manquantes en tant que valeurs manquantes.</li>
</ul>
<p>Le choix retenu modifiera les distances de Gower calculées. Supposons que l’on ait&nbsp;:</p>
<ol type="1">
<li>homme / grand / blond / étudiant / urbain</li>
<li>femme / grande / brune / étudiante / manquant</li>
</ol>
<p>Si l’on supprime les individus ayant des valeurs manquantes, 2 est retirée du fichier d’observations et aucune distance n’est calculée.</p>
<p>Si l’on traite les valeurs manquantes comme une modalité particulière, 1 et 2 partagent alors 2 caractères sur les 5 analysés, la distance de Gower entre eux est alors de 1&nbsp;−&nbsp;2/5&nbsp;=1&nbsp;−&nbsp;0,4&nbsp;=&nbsp;0,6.</p>
<p>Si on garde les valeurs manquantes, l’indice de Gower est dès lors calculé sur les seuls descripteurs renseignés à la fois pour 1 et 2. La distance de Gower sera calculée dans le cas présent uniquement sur les 4 caractères renseignés et vaudra 1&nbsp;−&nbsp;2/4&nbsp;=&nbsp;0,5.</p>
</section><section id="distance-du-φ²" class="level3" data-number="41.1.2"><h3 data-number="41.1.2" class="anchored" data-anchor-id="distance-du-φ²">
<span class="header-section-number">41.1.2</span> Distance du Φ²</h3>
<p>Il s’agit de la distance utilisée dans les analyses de correspondance multiples (ACM). C’est une variante de la distance du χ². Nous considérons ici que nous avons <em>Q</em> questions (soit <em>Q</em> variables initiales de type facteur). À chaque individu est associé un patron c’est-à-dire une certaine combinaison de réponses aux <em>Q</em> questions. La distance entre deux individus correspond à la distance entre leurs deux patrons. Si les deux individus présentent le même patron, leur distance sera nulle. La distance du Φ² peut s’exprimer ainsi&nbsp;:</p>
<p><span class="math display">\[
d_{\Phi^2}^2(L_i,L_j)=\frac{1}{Q}\sum_{k}\frac{(\delta_{ik}-\delta_{jk})^2}{f_k}
\]</span></p>
<p>où <span class="math inline">\(L_i\)</span> et <span class="math inline">\(L_j\)</span> sont deux patrons, <span class="math inline">\(Q\)</span> le nombre total de questions. <span class="math inline">\(\delta_{ik}\)</span> vaut 1 si la modalité <span class="math inline">\(k\)</span> est présente dans le patron <span class="math inline">\(L_i\)</span>, 0 sinon. <span class="math inline">\(f_k\)</span>est la fréquence de la modalité <span class="math inline">\(k\)</span> dans l’ensemble de la population.</p>
<p>Exprimé plus simplement, on fait la somme de l’inverse des fréquences des modalités non communes aux deux patrons, puis on divise par le nombre total de question. Si nous reprenons notre exemple précédent&nbsp;:</p>
<ol type="1">
<li>homme / grand / blond / étudiant / urbain</li>
<li>femme / grande / brune / étudiante / rurale</li>
</ol>
<p>Pour calculer la distance entre 1 et 2, il nous faut connaître la proportion des différentes modalités dans l’ensemble de la population étudiée. En l’occurrence&nbsp;:</p>
<ul>
<li>hommes&nbsp;: 52&nbsp;% / femmes&nbsp;: 48&nbsp;%</li>
<li>grand&nbsp;: 30&nbsp;% / moyen&nbsp;: 45&nbsp;% / petit&nbsp;: 25&nbsp;%</li>
<li>blond&nbsp;: 15&nbsp;% / châtain&nbsp;: 45&nbsp;% / brun&nbsp;: 30&nbsp;% / blanc&nbsp;: 10&nbsp;%</li>
<li>étudiant&nbsp;: 20 % / salariés&nbsp;: 65&nbsp;% / retraités&nbsp;: 15&nbsp;%</li>
<li>urbain&nbsp;: 80 % / rural&nbsp;: 20&nbsp;%</li>
</ul>
<p>Les modalités non communes entre les profils de 1 et 2 sont&nbsp;: homme, femme, blond, brun, urbain et rural. La distance du Φ² entre 1 et 2 est donc la suivante&nbsp;:</p>
<p><span class="math display">\[
d_{\Phi^2}^2(L_1,L_2)=\frac{1}{5}(\frac{1}{0,52}+\frac{1}{0,48}+\frac{1}{0,15}+\frac{1}{0,30}+\frac{1}{0,80}+\frac{1}{0,20})=4,05
\]</span></p>
<p>Cette distance, bien que moins intuitive que la distance de Gower évoquée précédemment, est la plus employée pour l’analyse d’enquêtes en sciences sociales. Il faut retenir que la distance entre deux profils est dépendante de la distribution globale de chaque modalité dans la population étudiée. Ainsi, si l’on recalcule les distances entre individus à partir d’un sous-échantillon, le résultat obtenu sera différent. De manière générale, les individus présentant des caractéristiques rares dans la population vont se retrouver éloignés des individus présentant des caractéristiques fortement représentées.</p>
</section><section id="illustration" class="level3" data-number="41.1.3"><h3 data-number="41.1.3" class="anchored" data-anchor-id="illustration">
<span class="header-section-number">41.1.3</span> Illustration</h3>
<p>Nous allons reprendre l’exemple utilisé au chapitre précédent sur l’analyse factorielle (cf. <a href="analyse-factorielle.html" class="quarto-xref"><span>Chapitre 40</span></a>) et portant sur les loisirs pratiqués par les répondants à l’enquête <em>histoire de vie</em> de 2003.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">data</span>(<span class="st">"hdv2003"</span>, <span class="at">package =</span> <span class="st">"questionr"</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>d <span class="ot">&lt;-</span> hdv2003 <span class="sc">|&gt;</span> </span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="fu">select</span>(hard.rock<span class="sc">:</span>sport)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculons maintenant une matrice de distances. Il s’agit d’une grande matrice carrée, avec autant de lignes et de colonnes que d’observations et indiquant la distance entre chaque individus pris deux à deux.</p>
<p>La distance de Gower se calcule avec <code><a href="https://rdrr.io/pkg/cluster/man/daisy.html">cluster::daisy()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>md_gower <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2"></a>  cluster<span class="sc">::</span><span class="fu">daisy</span>(<span class="at">metric =</span> <span class="st">"gower"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour la distance du Φ², nous allons d’abord réaliser une ACM avec <code>ade4::dudi.cm()</code> puis appeler <code><a href="https://rdrr.io/pkg/ade4/man/dist.dudi.html">ade4::dist.dudi()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>acm_ad <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  ade4<span class="sc">::</span><span class="fu">dudi.acm</span>(<span class="at">scannf =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>md_phi2 <span class="ot">&lt;-</span> acm_ad <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4"></a>  ade4<span class="sc">::</span><span class="fu">dist.dudi</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Astuce
</div>
</div>
<div class="callout-body-container callout-body">
<p>La distance du Φ² peut être calculée entre les observations (ce que nous venons de faire) afin de créer ensuite une typologie d’individus, mais il est également possible de calculer une distance du Φ² entre les modalités des variables afin de créer une typologie de variables. Dans ce cas-là, on appellera <code><a href="https://rdrr.io/pkg/ade4/man/dist.dudi.html">ade4::dist.dudi()</a></code> avec l’option <code>amongrow = FALSE</code>.</p>
</div>
</div>
</section></section><section id="calcul-du-dendrogramme" class="level2 page-columns page-full" data-number="41.2"><h2 data-number="41.2" class="anchored" data-anchor-id="calcul-du-dendrogramme">
<span class="header-section-number">41.2</span> Calcul du dendrogramme</h2>
<p>Il faut ensuite choisir une méthode d’agrégation pour construire le dendrogramme. De nombreuses solutions existent (saut minimum, distance maximum, moyenne, méthode de Ward…). Chacune d’elle produira un dendrogramme différent. Nous ne détaillerons pas ici ces différentes techniques<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;Les méthodes <em>single</em>, <em>complete</em>, <em>centroid</em>, <em>average</em> et <em>Ward</em> sont présentées succinctement dans le document <a href="https://www.learndatasci.com/glossary/hierarchical-clustering/"><em>Hierarchical Clustering</em></a> par Fatih Karabiber.</p></div><div id="fn6"><p><sup>6</sup>&nbsp;Ward, J. (1963). Hierarchical Grouping to Optimize an Objective Function. <em>Journal of the American Statistical Association</em>, 58(301), 236-244. doi:10.2307/2282967. (<a href="http://www.jstor.org/stable/2282967" class="uri">http://www.jstor.org/stable/2282967</a>)</p></div><div id="fn7"><p><sup>7</sup>&nbsp;Voir par exemple la discussion, en anglais, sur Wikipedia concernant la page présentant la méthode Ward&nbsp;: <a href="https://en.wikipedia.org/wiki/Talk:Ward%27s_method" class="uri">https://en.wikipedia.org/wiki/Talk:Ward%27s_method</a></p></div></div><p>Cependant, à l’usage, on privilégiera le plus souvent la méthode de Ward<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>. De manière simplifiée, cette méthode cherche à minimiser l’inertie intra-classe et à maximiser l’inertie inter-classe afin d’obtenir des classes les plus homogènes possibles. Cette méthode est souvent incorrectement présentée comme une <q>méthode de minimisation de la variance</q> alors qu’au sens strict Ward vise <q>l’augmentation minimum de la somme des carrés</q> (“<em>minimum increase of sum-of-squares (of errors)</em>”)<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p>
<p>En raison de la variété des distances possibles et de la variété des techniques d’agrégation, on pourra être amené à réaliser plusieurs dendrogrammes différents sur un même jeu de données jusqu’à obtenir une classification qui fait «&nbsp;sens&nbsp;».</p>
<p>La fonction de base pour le calcul d’un dendrogramme est <code><a href="https://rdrr.io/r/stats/hclust.html">stats::hclust()</a></code> en précisant le critère d’agrégation avec <code>method</code>. Dans notre cas, nous allons opter pour la méthode de Ward appliquée au carré des distances (ce qu’on indique avec <code>method = "ward.D2"</code><a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>)&nbsp;:</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>&nbsp;L’option <code>method = "ward.D"</code> correspondant à la méthode de Ward sur la matrice des distances simples (i.e.&nbsp;sans la passer <q>au carré</q>). Mais il est à noter que la méthode décrite par Ward dans son article de 1963 correspond bien à <code>method = "ward.D2"</code>.</p></div></div><div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>arbre_phi2 <span class="ot">&lt;-</span> md_phi2 <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="fu">hclust</span>(<span class="at">method =</span> <span class="st">"ward.D2"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Astuce
</div>
</div>
<div class="callout-body-container callout-body">
<p>Le temps de calcul d’un dendrogramme peut être particulièrement important sur un gros fichier de données. Le package <a href="https://danifold.net/fastcluster.html">fastcluster</a> permet de réduire significativement ce temps de calcul. Elle propose une version optimisée de <code><a href="https://rdrr.io/r/stats/hclust.html">hclust()</a></code> (les arguments sont identiques).</p>
<p>Il suffira donc de charger <a href="https://danifold.net/fastcluster.html">fastcluster</a> pour surcharger la fonction <code><a href="https://rdrr.io/r/stats/hclust.html">hclust()</a></code>, ou bien d’appeler explicitement <code><a href="https://rdrr.io/pkg/fastcluster/man/hclust.html">fastcluster::hclust()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>arbre_gower <span class="ot">&lt;-</span> md_gower <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  fastcluster<span class="sc">::</span><span class="fu">hclust</span>(<span class="at">method =</span> <span class="st">"ward.D2"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Le dendrogramme peut également être calculé avec la fonction <code><a href="https://rdrr.io/pkg/cluster/man/agnes.html">cluster::agnes()</a></code>. Cependant, à l’usage, le temps de calcul peut être plus long qu’avec <code><a href="https://rdrr.io/r/stats/hclust.html">hclust()</a></code>.</p>
<p>Les noms des arguments sont légèrement différents. Pour la méthode de Ward appliquée au carré de la matrice des distance, on précisera à <code><a href="https://rdrr.io/pkg/cluster/man/agnes.html">cluster::agnes()</a></code> l’option <code>method = "ward"</code>.</p>
<p>Le résultat obtenu n’est pas au même format que celui de <code><a href="https://rdrr.io/r/stats/hclust.html">stats::hclust()</a></code>. Il est possible de transformer un objet <code><a href="https://rdrr.io/pkg/cluster/man/agnes.html">cluster::agnes()</a></code> au format <code><a href="https://rdrr.io/r/stats/hclust.html">stats::hclust()</a></code> avec <code>cluster::as.hclust()</code>.</p>
</div>
</div>
<section id="représentation-graphique-du-dendrogramme" class="level3 page-columns page-full" data-number="41.2.1"><h3 data-number="41.2.1" class="anchored" data-anchor-id="représentation-graphique-du-dendrogramme">
<span class="header-section-number">41.2.1</span> Représentation graphique du dendrogramme</h3>
<p>Pour une représentation graphique rapide du dendrogramme, on peut directement <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>. Lorsque le nombre d’individus est important, il peut être utile de ne pas afficher les étiquettes des individus avec <code>labels = FALSE</code>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>arbre_gower <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">plot</span>(<span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">"Dendrogramme (distance de Gower)"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-plot-dendrogram" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-plot-dendrogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-plot-dendrogram-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" data-glightbox="description: .lightbox-desc-1"><img src="classification-ascendante-hierarchique_files/figure-html/fig-plot-dendrogram-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-plot-dendrogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.1: Représentation graphique du dendrogramme avec plot()
</figcaption></figure>
</div>
</div>
</div>
<p>Pour une représentation graphique un peu plus propre (et avec plus d’options que nous verrons plus loin), nous pouvons avoir recours à <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_dend.html">factoextra::fviz_dend()</a></code> du package <a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a>. Le temps de calcul du graphique est par contre sensible plus long.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>arbre_gower <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>  factoextra<span class="sc">::</span><span class="fu">fviz_dend</span>(<span class="at">show_labels =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">"Dendrogramme (distance de Gower)"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-fviz_dend-dendrogram" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-fviz_dend-dendrogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-fviz_dend-dendrogram-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" data-glightbox="description: .lightbox-desc-2"><img src="classification-ascendante-hierarchique_files/figure-html/fig-fviz_dend-dendrogram-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-fviz_dend-dendrogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.2: Représentation graphique du dendrogramme avec fviz_dend()
</figcaption></figure>
</div>
</div>
</div>
<p>Il existe d’autres packages offrant des visualisations avancées pour les dendrogrammes. Citons notamment le package <a href="https://andrie.github.io/ggdendro/">ggdendro</a> et surtout <a href="http://talgalili.github.io/dendextend/">dendextend</a> qui est très complet.</p>
</section></section><section id="découper-le-dendrogramme" class="level2 page-columns page-full" data-number="41.3"><h2 data-number="41.3" class="anchored" data-anchor-id="découper-le-dendrogramme">
<span class="header-section-number">41.3</span> Découper le dendrogramme</h2>
<p>Pour obtenir une partition de la population, il suffit de découper le dendrogramme obtenu à une certaine hauteur. Cela aura pour effet de découper l’échantillon en plusieurs groupes, i.e.&nbsp;en plusieurs classes.</p>
<section id="classes-obtenues-avec-la-distance-de-gower" class="level3 page-columns page-full" data-number="41.3.1"><h3 data-number="41.3.1" class="anchored" data-anchor-id="classes-obtenues-avec-la-distance-de-gower">
<span class="header-section-number">41.3.1</span> Classes obtenues avec la distance de Gower</h3>
<p>En premier lieu, il est toujours bon de prendre le temps d’observer de la forme des branches du dendrogramme. Reprenons le dendrogramme obtenu avec la distance de Gower (<a href="#fig-fviz_dend-dendrogram" class="quarto-xref">Figure&nbsp;<span>41.2</span></a>). Nous recherchons des branches qui se distinguent <q>clairement</q>, c’est-à-dire avec un <q>saut</q> marqué sous la branche. Ici, nous avons tout d’abord deux groupes bien distincts qui apparaissent. Chacune des deux premières branches se sépare ensuite en deux branches bien visibles, suggérant une possible classification en 4 groupes.</p>
<p>Nous pouvons l’impact d’un découpage avec <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_dend.html">factoextra::fviz_dend()</a></code> en précisant <code>k = 4</code> pour lui indiquer de colorer un découpage en 4 classes. On peut optionnellement ajouter <code>rect = TRUE</code> pour dessiner des rectangles autour de chaque classe.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>arbre_gower <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2"></a>  factoextra<span class="sc">::</span><span class="fu">fviz_dend</span>(</span>
<span id="cb8-3"><a href="#cb8-3"></a>    <span class="at">show_labels =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="at">k =</span> <span class="dv">4</span>,</span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="at">rect =</span> <span class="cn">TRUE</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>  ) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">"Dendrogramme découpé en 4 classes (distance de Gowver)"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-fviz_dend-dendrogram-4-classes" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-fviz_dend-dendrogram-4-classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-fviz_dend-dendrogram-4-classes-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" data-glightbox="description: .lightbox-desc-3"><img src="classification-ascendante-hierarchique_files/figure-html/fig-fviz_dend-dendrogram-4-classes-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-fviz_dend-dendrogram-4-classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.3: Représentation graphique du dendrogramme avec fviz_dend()
</figcaption></figure>
</div>
</div>
</div>
<p>Pour nous aider dans l’analyse du dendrogramme, il est possible de représenter graphiquement les sauts d’inertie (i.e.&nbsp;de la hauteur des branches) au fur-et-à-mesure que l’on découpe l’arbre en un nombre de classes plus important. Nous pouvons également considérer la perte absolue d’inertie (l’écart de hauteur entre le découpage précédent et le découpage considéré) voire la perte relative (i.e.&nbsp;la perte absolue exprimée en pourcentage de la hauteur précédente). <a href="http://factominer.free.fr">FactoMineR</a> (que nous aborderons un peu plus loin) suggère par défaut la partition correspondant à la plus grande perte relative d’inertie (<em>the one with the higher relative loss of inertia</em>).</p>
<p>Pour faciliter les choses, voici deux petites fonctions que vous pouvez recopier / adapter dans vos scripts. <code>get_inertia_from_tree()</code> calcule l’inertie à chaque niveau, ainsi que les pertes absolues et relatives. <code>plot_inertia_from_tree()</code> en propose une représentation graphique.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>get_inertia_from_tree <span class="ot">&lt;-</span> <span class="cf">function</span>(tree, <span class="at">k_max =</span> <span class="dv">15</span>) {</span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(tree, <span class="st">"HCPC"</span>))</span>
<span id="cb9-3"><a href="#cb9-3"></a>    tree <span class="ot">&lt;-</span> tree<span class="sc">$</span>call<span class="sc">$</span>t<span class="sc">$</span>tree</span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">inherits</span>(tree, <span class="st">"hclust"</span>))</span>
<span id="cb9-5"><a href="#cb9-5"></a>    tree <span class="ot">&lt;-</span> <span class="fu">as.hclust</span>(tree)</span>
<span id="cb9-6"><a href="#cb9-6"></a>  inertia <span class="ot">&lt;-</span> tree<span class="sc">$</span>height <span class="sc">|&gt;</span> </span>
<span id="cb9-7"><a href="#cb9-7"></a>    <span class="fu">sort</span>(<span class="at">decreasing =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-8"><a href="#cb9-8"></a>    <span class="fu">head</span>(k_max)</span>
<span id="cb9-9"><a href="#cb9-9"></a>  prev_inertia <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(inertia)</span>
<span id="cb9-10"><a href="#cb9-10"></a>  dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb9-11"><a href="#cb9-11"></a>    <span class="at">k =</span> <span class="fu">seq_along</span>(inertia),</span>
<span id="cb9-12"><a href="#cb9-12"></a>    <span class="at">inertia =</span> inertia,</span>
<span id="cb9-13"><a href="#cb9-13"></a>    <span class="at">absolute_loss =</span> inertia <span class="sc">-</span> prev_inertia,</span>
<span id="cb9-14"><a href="#cb9-14"></a>    <span class="at">relative_loss =</span> (inertia <span class="sc">-</span> prev_inertia) <span class="sc">/</span> prev_inertia</span>
<span id="cb9-15"><a href="#cb9-15"></a>  )</span>
<span id="cb9-16"><a href="#cb9-16"></a>}</span>
<span id="cb9-17"><a href="#cb9-17"></a></span>
<span id="cb9-18"><a href="#cb9-18"></a>plot_inertia_from_tree <span class="ot">&lt;-</span> <span class="cf">function</span>(tree, <span class="at">k_max =</span> <span class="dv">15</span>) {</span>
<span id="cb9-19"><a href="#cb9-19"></a>  d <span class="ot">&lt;-</span> <span class="fu">get_inertia_from_tree</span>(tree, k_max)</span>
<span id="cb9-20"><a href="#cb9-20"></a>  p_inertia <span class="ot">&lt;-</span> </span>
<span id="cb9-21"><a href="#cb9-21"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(d) <span class="sc">+</span></span>
<span id="cb9-22"><a href="#cb9-22"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> inertia) <span class="sc">+</span></span>
<span id="cb9-23"><a href="#cb9-23"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_step</span>() <span class="sc">+</span></span>
<span id="cb9-24"><a href="#cb9-24"></a>    ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">"Inertia"</span>)</span>
<span id="cb9-25"><a href="#cb9-25"></a>  p_absolute <span class="ot">&lt;-</span></span>
<span id="cb9-26"><a href="#cb9-26"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(d) <span class="sc">+</span></span>
<span id="cb9-27"><a href="#cb9-27"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> absolute_loss) <span class="sc">+</span></span>
<span id="cb9-28"><a href="#cb9-28"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#4477AA"</span>) <span class="sc">+</span></span>
<span id="cb9-29"><a href="#cb9-29"></a>    ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">"Absolute loss"</span>)</span>
<span id="cb9-30"><a href="#cb9-30"></a>  p_relative <span class="ot">&lt;-</span></span>
<span id="cb9-31"><a href="#cb9-31"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(d) <span class="sc">+</span></span>
<span id="cb9-32"><a href="#cb9-32"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> relative_loss) <span class="sc">+</span></span>
<span id="cb9-33"><a href="#cb9-33"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#AA3377"</span>) <span class="sc">+</span></span>
<span id="cb9-34"><a href="#cb9-34"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#AA3377"</span>) <span class="sc">+</span></span>
<span id="cb9-35"><a href="#cb9-35"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb9-36"><a href="#cb9-36"></a>    ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="st">"Relative loss"</span>)</span>
<span id="cb9-37"><a href="#cb9-37"></a>  patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(</span>
<span id="cb9-38"><a href="#cb9-38"></a>    p_inertia,</span>
<span id="cb9-39"><a href="#cb9-39"></a>    p_absolute,</span>
<span id="cb9-40"><a href="#cb9-40"></a>    p_relative,</span>
<span id="cb9-41"><a href="#cb9-41"></a>    <span class="at">ncol =</span> <span class="dv">1</span></span>
<span id="cb9-42"><a href="#cb9-42"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb9-43"><a href="#cb9-43"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_light</span>() <span class="sc">&amp;</span></span>
<span id="cb9-44"><a href="#cb9-44"></a>    ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="st">"Number of clusters"</span>) <span class="sc">&amp;</span></span>
<span id="cb9-45"><a href="#cb9-45"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(</span>
<span id="cb9-46"><a href="#cb9-46"></a>      <span class="at">breaks =</span> d<span class="sc">$</span>k,</span>
<span id="cb9-47"><a href="#cb9-47"></a>      <span class="at">minor_breaks =</span> <span class="cn">NULL</span>,</span>
<span id="cb9-48"><a href="#cb9-48"></a>      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, k_max)</span>
<span id="cb9-49"><a href="#cb9-49"></a>    )</span>
<span id="cb9-50"><a href="#cb9-50"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Voyons ce qu’on obtient.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>arbre_gower <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">plot_inertia_from_tree</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-plot_inertia_from_tree-gower" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-plot_inertia_from_tree-gower-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-plot_inertia_from_tree-gower-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" data-glightbox="description: .lightbox-desc-4"><img src="classification-ascendante-hierarchique_files/figure-html/fig-plot_inertia_from_tree-gower-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-plot_inertia_from_tree-gower-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.4: Inertie, perte absolue et perte relative d’inertie pour différents découpages en classes (distance de Gower)
</figcaption></figure>
</div>
</div>
</div>
<p>Dans cet exemple, nous pouvons voir qu’un découpage en deux classes maximise la perte absolue et la perte relative d’inertie. Mais, pour les besoins de l’analyse, nous pouvons souhaiter un nombre de classe un peu plus élevé (plus de classes permet une analyse plus fine, trop de classes rend l’interprétation des résultats compliqués). Un découpage en 4 classes apparaît sur ce graphique comme une bonne alternative, voir un découpage en 6 classes (une lecture du dendrogramme nous permet de voir que, dans cet exemple, un découpage en 6 classes reviendrait à couper en deux les 2 classes les plus larges du découpage en 4 classes).</p>
<p>Pour découper notre dendrogramme et récupérer la classification, nous appliquerons la fonction <code><a href="https://rdrr.io/r/stats/cutree.html">cutree()</a></code> au dendrogramme, en indiquant le nombre de classes souhaitées<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn9"><p><sup>9</sup>&nbsp;Ici, nous pouvons ajouter le résultat obtenu directement à notre tableau de données <code>hdv2003</code> dans la mesure où, depuis le début de l’analyse, l’ordre des lignes n’a jamais changé à aucune étape de l’analyse.</p></div></div><div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>hdv2003<span class="sc">$</span>typo_gower_4classes <span class="ot">&lt;-</span> arbre_gower <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">cutree</span>(<span class="dv">4</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous pouvons rapidement faire un tri à plat avec <code><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_summary.html">gtsummary::tbl_summary()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">theme_gtsummary_language</span>(<span class="st">"fr"</span>, <span class="at">decimal.mark =</span> <span class="st">","</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>hdv2003 <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">tbl_summary</span>(<span class="at">include =</span> typo_gower_4classes)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tbl_summary-typo_gower_4classes" class="cell quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-tbl_summary-typo_gower_4classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="bbfbxdeolm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bbfbxdeolm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bbfbxdeolm thead, #bbfbxdeolm tbody, #bbfbxdeolm tfoot, #bbfbxdeolm tr, #bbfbxdeolm td, #bbfbxdeolm th {
  border-style: none;
}

#bbfbxdeolm p {
  margin: 0;
  padding: 0;
}

#bbfbxdeolm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bbfbxdeolm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bbfbxdeolm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bbfbxdeolm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bbfbxdeolm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bbfbxdeolm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bbfbxdeolm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bbfbxdeolm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bbfbxdeolm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bbfbxdeolm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bbfbxdeolm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bbfbxdeolm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bbfbxdeolm .gt_spanner_row {
  border-bottom-style: hidden;
}

#bbfbxdeolm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bbfbxdeolm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bbfbxdeolm .gt_from_md > :first-child {
  margin-top: 0;
}

#bbfbxdeolm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bbfbxdeolm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bbfbxdeolm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bbfbxdeolm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bbfbxdeolm .gt_row_group_first td {
  border-top-width: 2px;
}

#bbfbxdeolm .gt_row_group_first th {
  border-top-width: 2px;
}

#bbfbxdeolm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bbfbxdeolm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bbfbxdeolm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bbfbxdeolm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bbfbxdeolm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bbfbxdeolm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bbfbxdeolm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bbfbxdeolm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bbfbxdeolm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bbfbxdeolm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bbfbxdeolm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bbfbxdeolm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bbfbxdeolm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bbfbxdeolm .gt_left {
  text-align: left;
}

#bbfbxdeolm .gt_center {
  text-align: center;
}

#bbfbxdeolm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bbfbxdeolm .gt_font_normal {
  font-weight: normal;
}

#bbfbxdeolm .gt_font_bold {
  font-weight: bold;
}

#bbfbxdeolm .gt_font_italic {
  font-style: italic;
}

#bbfbxdeolm .gt_super {
  font-size: 65%;
}

#bbfbxdeolm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bbfbxdeolm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bbfbxdeolm .gt_indent_1 {
  text-indent: 5px;
}

#bbfbxdeolm .gt_indent_2 {
  text-indent: 10px;
}

#bbfbxdeolm .gt_indent_3 {
  text-indent: 15px;
}

#bbfbxdeolm .gt_indent_4 {
  text-indent: 20px;
}

#bbfbxdeolm .gt_indent_5 {
  text-indent: 25px;
}

#bbfbxdeolm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bbfbxdeolm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead><tr class="header gt_col_headings">
<th id="<div data-qmd-base64=&quot;KipDYXJhY3TDqXJpc3RpcXVlKio=&quot;><div class='gt_from_md'><p><strong>Caractéristique</strong></p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><p><strong>Caractéristique</strong></p></th>
<th id="<div data-qmd-base64=&quot;KipOID0gMuKAiTAwMCoq&quot;><div class='gt_from_md'><p><strong>N = 2 000</strong></p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<p><strong>N = 2 000</strong></p>
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span>
</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">typo_gower_4classes</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="stat_0">837 (42%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2</td>
<td class="gt_row gt_center" headers="stat_0">636 (32%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;3</td>
<td class="gt_row gt_center" headers="stat_0">172 (8,6%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;4</td>
<td class="gt_row gt_center" headers="stat_0">355 (18%)</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr class="even">
<td colspan="2" class="gt_footnote">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span>
<p>n (%)</p>
</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-tbl_summary-typo_gower_4classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;41.1: Distribution de la typologie en 4 classes obtenues à partir de la distance de Gower
</figcaption></figure>
</div>
</div>
<p>Nous obtenons deux classes principales regroupant chacune plus du tiers de l’échantillon, une troisième classe regroupant presque un cinquième et une dernière classe avec un peu moins de 9&nbsp;% des individus.</p>
</section><section id="classes-obtenues-à-partir-de-lacm-distance-du-φ²" class="level3 page-columns page-full" data-number="41.3.2"><h3 data-number="41.3.2" class="anchored" data-anchor-id="classes-obtenues-à-partir-de-lacm-distance-du-φ²">
<span class="header-section-number">41.3.2</span> Classes obtenues à partir de l’ACM (distance du Φ²)</h3>
<p>Pour découper l’arbre obtenu à partir de l’ACM, nous allons procéder de la même manière. D’abord, jetons un œil au dendrogramme.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>arbre_phi2 <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>  factoextra<span class="sc">::</span><span class="fu">fviz_dend</span>(<span class="at">show_labels =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">"Dendrogramme (distance du Phi²)"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-fviz_dend-dendrogram-phi2" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-fviz_dend-dendrogram-phi2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-fviz_dend-dendrogram-phi2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" data-glightbox="description: .lightbox-desc-5"><img src="classification-ascendante-hierarchique_files/figure-html/fig-fviz_dend-dendrogram-phi2-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-fviz_dend-dendrogram-phi2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.5: Représentation graphique du dendrogramme issu de l’ACM
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Le dendrogramme obtenu est ici bien différent. Cela est lié au fait que les deux distances traitent différemment les modalités <q>atypiques</q>. En effet, la distance du Φ² prend en compte la fréquence de chaque modalité dans l’ensemble de l’échantillon. De fait, les modalités très peu représentées dans l’échantillon se retrouvent très éloignées des autres et la CAH aura tendance à isoler les individus atypiques. À l’inverse, la distance de Gower est indépendante de la fréquence de chaque modalité dans l’échantillon. De fait, plutôt que d’isoler les individus atypiques, une CAH basée sur la distance de Gower aura plutôt tendance à les associer aux autres à partir de leurs autres caractéristiques, aboutissant à des classes plus <q>équilibrées</q>.</p>
<p>Il n’y a pas une approche <q>meilleure</q> que l’autre. Tout dépend des questions de recherche que l’on se posent et de ce que l’on souhaite faire émerger.</p>
</div>
</div>
<p>Comme nous pouvons le voir, dès le début du dendrogramme, l’arbre se divise rapidement en 5 branches puis il y a un saut relativement marqué. Nous pouvons confirmer cela avec <code>plot_inertia_from_tree()</code>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>arbre_phi2 <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">plot_inertia_from_tree</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-plot_inertia_from_tree-phi2" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-plot_inertia_from_tree-phi2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-plot_inertia_from_tree-phi2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" data-glightbox="description: .lightbox-desc-6"><img src="classification-ascendante-hierarchique_files/figure-html/fig-plot_inertia_from_tree-phi2-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-plot_inertia_from_tree-phi2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.6: Inertie, perte absolue et perte relative d’inertie pour différents découpages en classes (distance de Phi²)
</figcaption></figure>
</div>
</div>
</div>
<p>Cela confirme un découpage <q>optimal</q> en 5 classes. Regardons la distribution de cette typologie.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>hdv2003<span class="sc">$</span>typo_phi2_5classes <span class="ot">&lt;-</span> arbre_phi2 <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">cutree</span>(<span class="dv">5</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>hdv2003 <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">tbl_summary</span>(<span class="at">include =</span> typo_phi2_5classes)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tbl_summary-typo_phi2_5classes" class="cell quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-tbl_summary-typo_phi2_5classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="kxiwzfgxma" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kxiwzfgxma table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kxiwzfgxma thead, #kxiwzfgxma tbody, #kxiwzfgxma tfoot, #kxiwzfgxma tr, #kxiwzfgxma td, #kxiwzfgxma th {
  border-style: none;
}

#kxiwzfgxma p {
  margin: 0;
  padding: 0;
}

#kxiwzfgxma .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kxiwzfgxma .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kxiwzfgxma .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kxiwzfgxma .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kxiwzfgxma .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kxiwzfgxma .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kxiwzfgxma .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kxiwzfgxma .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kxiwzfgxma .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kxiwzfgxma .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kxiwzfgxma .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kxiwzfgxma .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kxiwzfgxma .gt_spanner_row {
  border-bottom-style: hidden;
}

#kxiwzfgxma .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kxiwzfgxma .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kxiwzfgxma .gt_from_md > :first-child {
  margin-top: 0;
}

#kxiwzfgxma .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kxiwzfgxma .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kxiwzfgxma .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kxiwzfgxma .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kxiwzfgxma .gt_row_group_first td {
  border-top-width: 2px;
}

#kxiwzfgxma .gt_row_group_first th {
  border-top-width: 2px;
}

#kxiwzfgxma .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxiwzfgxma .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kxiwzfgxma .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kxiwzfgxma .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kxiwzfgxma .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxiwzfgxma .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kxiwzfgxma .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kxiwzfgxma .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kxiwzfgxma .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kxiwzfgxma .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kxiwzfgxma .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxiwzfgxma .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kxiwzfgxma .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxiwzfgxma .gt_left {
  text-align: left;
}

#kxiwzfgxma .gt_center {
  text-align: center;
}

#kxiwzfgxma .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kxiwzfgxma .gt_font_normal {
  font-weight: normal;
}

#kxiwzfgxma .gt_font_bold {
  font-weight: bold;
}

#kxiwzfgxma .gt_font_italic {
  font-style: italic;
}

#kxiwzfgxma .gt_super {
  font-size: 65%;
}

#kxiwzfgxma .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kxiwzfgxma .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kxiwzfgxma .gt_indent_1 {
  text-indent: 5px;
}

#kxiwzfgxma .gt_indent_2 {
  text-indent: 10px;
}

#kxiwzfgxma .gt_indent_3 {
  text-indent: 15px;
}

#kxiwzfgxma .gt_indent_4 {
  text-indent: 20px;
}

#kxiwzfgxma .gt_indent_5 {
  text-indent: 25px;
}

#kxiwzfgxma .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kxiwzfgxma div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead><tr class="header gt_col_headings">
<th id="<div data-qmd-base64=&quot;KipDYXJhY3TDqXJpc3RpcXVlKio=&quot;><div class='gt_from_md'><p><strong>Caractéristique</strong></p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><p><strong>Caractéristique</strong></p></th>
<th id="<div data-qmd-base64=&quot;KipOID0gMuKAiTAwMCoq&quot;><div class='gt_from_md'><p><strong>N = 2 000</strong></p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<p><strong>N = 2 000</strong></p>
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span>
</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">typo_phi2_5classes</td>
<td class="gt_row gt_center" headers="stat_0"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="stat_0">1 010 (51%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2</td>
<td class="gt_row gt_center" headers="stat_0">713 (36%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;3</td>
<td class="gt_row gt_center" headers="stat_0">216 (11%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;4</td>
<td class="gt_row gt_center" headers="stat_0">14 (0,7%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;5</td>
<td class="gt_row gt_center" headers="stat_0">47 (2,4%)</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr class="odd">
<td colspan="2" class="gt_footnote">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span>
<p>n (%)</p>
</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-tbl_summary-typo_phi2_5classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;41.2: Distribution de la typologie en 5 classes obtenues à partir de la distance du Phi²
</figcaption></figure>
</div>
</div>
<p>Sur les 5 classes, deux sont très atypiques puisqu’elles ne réunissent que 0,7&nbsp;% et 2,4&nbsp;% de l’échantillon. À voir si cela est problématique pour la suite de l’analyse. Au besoin, nous pourrions envisager de fusionner les classes 4 et 5 avec la classe 2 avec laquelle elles sont plus proches selon le dendrogramme.</p>
<p>Il est possible de visualiser la répartition de la typologie dans le plan factoriel avec <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_mca.html">factoextra::fviz_mca_ind()</a></code> et en passant la typologie à <code>habillage</code>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>acm_ad <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>  factoextra<span class="sc">::</span><span class="fu">fviz_mca_ind</span>(</span>
<span id="cb18-3"><a href="#cb18-3"></a>    <span class="at">habillage =</span> hdv2003<span class="sc">$</span>typo_phi2_5classes,</span>
<span id="cb18-4"><a href="#cb18-4"></a>    <span class="at">addEllipses =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-5"><a href="#cb18-5"></a>    <span class="at">geom.ind =</span> <span class="st">"point"</span>,</span>
<span id="cb18-6"><a href="#cb18-6"></a>    <span class="at">alpha.ind =</span> <span class="fl">0.1</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>  )</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-fviz_mca_ind-habillage-typo_phi2_5classes" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-fviz_mca_ind-habillage-typo_phi2_5classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-fviz_mca_ind-habillage-typo_phi2_5classes-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" data-glightbox="description: .lightbox-desc-7"><img src="classification-ascendante-hierarchique_files/figure-html/fig-fviz_mca_ind-habillage-typo_phi2_5classes-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-fviz_mca_ind-habillage-typo_phi2_5classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.7: Projection de la typologie dans le plan factoriel de l’ACM
</figcaption></figure>
</div>
</div>
</div>
<p>Nous voyons que les classes 1, 2 et 3 séparent bien les individus au niveau du plan factoriel. Les deux classes atypiques 4 et 5, quant à elles, sont diffuses sur les deux premiers axes, suggérant qu’elles capturent des différences observables sur des axes de niveau supérieur.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Il existe de multiples autres indicateurs statistiques cherchant à mesurer la <q>qualité</q> de chaque partition. Pour cela, on pourra par exemple avoir recours à la fonction <code><a href="https://rdrr.io/pkg/WeightedCluster/man/as.clustrange.html">WeightedCluster::as.clustrange()</a></code> de l’extension <a href="http://mephisto.unige.ch/weightedcluster/">WeightedCluster</a>.</p>
<p>Pour plus d’informations, voir le <a href="https://cran.r-project.org/web/packages/WeightedCluster/vignettes/WeightedClusterFR.pdf"><em>manuel de la librairie WeightedCluster</em></a>, chapitre 7.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>WeightedCluster<span class="sc">::</span><span class="fu">as.clustrange</span>(arbre_phi2, md_phi2) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'vegan':
  method     from      
  rev.hclust dendextend</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-19-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="classification-ascendante-hierarchique_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>On pourra également lire <a href="https://www.datanovia.com/en/lessons/determining-the-optimal-number-of-clusters-3-must-know-methods/"><em>Determining The Optimal Number Of Clusters: 3 Must Know Methods</em></a> par Alboukadel Kassambara, l’un des auteurs du package <a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a>.</p>
</div>
</div>
</section></section><section id="calcul-de-lacm-et-de-la-cah-avec-factominer" class="level2 page-columns page-full" data-number="41.4"><h2 data-number="41.4" class="anchored" data-anchor-id="calcul-de-lacm-et-de-la-cah-avec-factominer">
<span class="header-section-number">41.4</span> Calcul de l’ACM et de la CAH avec <code>FactoMineR</code>
</h2>
<p>Le package <a href="http://factominer.free.fr">FactoMineR</a> permet lui aussi de réaliser une CAH à partir d’une ACM via la fonction <code><a href="https://rdrr.io/pkg/FactoMineR/man/HCPC.html">FactoMineR::HCPC()</a></code> qui réalise les différentes opérations en une seule fois.</p>
<p><code><a href="https://rdrr.io/pkg/FactoMineR/man/HCPC.html">FactoMineR::HCPC()</a></code> réalise à la fois le calcul de la matrice des distances, du dendrogramme et le partitionnement de la population en classes. Par défaut, <code><a href="https://rdrr.io/pkg/FactoMineR/man/HCPC.html">FactoMineR::HCPC()</a></code> calcule le dendrogramme à partir du carré des distances du Φ² et avec la méthode de Ward. Si l’on ne précise rien, <code><a href="https://rdrr.io/pkg/FactoMineR/man/HCPC.html">FactoMineR::HCPC()</a></code> détermine une partition optimale selon le critère de la plus perte relative d’inertie évoqué plus haut<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>. La fonction prend en entrée une analyse factorielle réalisée avec <a href="http://factominer.free.fr">FactoMineR</a>. Le paramètre <code>min</code> permet d’indiquer un nombre minimum de classes.</p>
<div class="no-row-height column-margin column-container"><div id="fn10"><p><sup>10</sup>&nbsp;Plus précisément si <code>graph = FALSE</code> ou si <code>nb.clust = -1</code>. Si <code>graph = TRUE</code> <strong>et</strong> <code>nb.clust = 0</code> (valeurs par défaut), la fonction affichera un dendrogramme interactif et l’utilisateur devra cliquer au niveau de la hauteur où il souhaite réaliser la découpe.</p></div></div><div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>acm_fm <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">MCA</span>(d, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>cah_fm <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">HCPC</span>(acm_fm, <span class="at">graph =</span> <span class="cn">FALSE</span>, <span class="at">min =</span> <span class="dv">3</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous pouvons directement passer le résultat de <code><a href="https://rdrr.io/pkg/FactoMineR/man/HCPC.html">FactoMineR::HCPC()</a></code> à <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_dend.html">factoextra::fviz_dend()</a></code> pour visualiser le dendrogramme, qui sera d’ailleurs automatiquement colorié à partir de la partition recommandée par <code><a href="https://rdrr.io/pkg/FactoMineR/man/HCPC.html">FactoMineR::HCPC()</a></code>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>cah_fm <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  factoextra<span class="sc">::</span><span class="fu">fviz_dend</span>(<span class="at">show_labels =</span> <span class="cn">FALSE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-fviz_dend-dendrogram-cah_fm" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-fviz_dend-dendrogram-cah_fm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-fviz_dend-dendrogram-cah_fm-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" data-glightbox="description: .lightbox-desc-9"><img src="classification-ascendante-hierarchique_files/figure-html/fig-fviz_dend-dendrogram-cah_fm-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-fviz_dend-dendrogram-cah_fm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.8: Représentation graphique du dendrogramme issu de l’ACM réalisée avec FactoMineR
</figcaption></figure>
</div>
</div>
</div>
<p>Nous obtenons ici un découpage en 6 classes qui correspond bien à la plus grand perte relative d’inertie comme nous pouvons le vérifier avec <code>plot_inertia_from_tree()</code> qui accepte également en entrée un objet produit par <code><a href="https://rdrr.io/pkg/FactoMineR/man/HCPC.html">FactoMineR::HCPC()</a></code>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>cah_fm <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">plot_inertia_from_tree</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-plot_inertia_from_tree-cah_fm" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-plot_inertia_from_tree-cah_fm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-plot_inertia_from_tree-cah_fm-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" data-glightbox="description: .lightbox-desc-10"><img src="classification-ascendante-hierarchique_files/figure-html/fig-plot_inertia_from_tree-cah_fm-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-plot_inertia_from_tree-cah_fm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.9: Inertie, perte absolue et perte relative d’inertie pour différents découpages en classes à partir du résultat de HCPC()
</figcaption></figure>
</div>
</div>
</div>
<p>Par contre, le dendrogramme obtenu diffère de celui que nous avions eu précédemment avec <a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a> (cf. <a href="#fig-fviz_dend-dendrogram-phi2" class="quarto-xref">Figure&nbsp;<span>41.5</span></a>). Cela est dû au fait que <code><a href="https://rdrr.io/pkg/FactoMineR/man/HCPC.html">FactoMineR::HCPC()</a></code> procède différemment pour calculer la matrice des distances en ne prenant en compte que les axes retenus dans le cadre de l’ACM.</p>
<p>Pour rappel, par défaut, <code><a href="https://rdrr.io/pkg/FactoMineR/man/MCA.html">FactoMineR::MCA()</a></code> ne retient que les 5 premiers axes de l’espace factoriel. <code><a href="https://rdrr.io/pkg/FactoMineR/man/HCPC.html">FactoMineR::HCPC()</a></code> n’a donc pris en compte que ces 5 premiers axes pour calculer les distances entre les individus, considérant que les autres axes n’apportent que du «&nbsp;bruit&nbsp;» rendant la classification instable. Comme le montre <code>summary(acm_fm)</code>, nos cinq premiers axes n’expliquent que 78&nbsp;% de la variance. On considère usuellement préférable de garder un plus grande nombre d’axes afin de couvrir au moins 80 à 90&nbsp;% de la variance.</p>
<p>De son côté, <code><a href="https://rdrr.io/pkg/ade4/man/dist.dudi.html">ade4::dist.dudi()</a></code> prends en compte l’ensemble des axes pour calculer la matrice des distances. On peut reproduire cela avec <a href="http://factominer.free.fr">FactoMineR</a> en indiquant <code>ncp = Inf</code> lors du calcul de l’ACM.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>acm_fm2 <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">MCA</span>(d, <span class="at">graph =</span> <span class="cn">FALSE</span>, <span class="at">ncp =</span> <span class="cn">Inf</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>cah_fm2 <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">HCPC</span>(acm_fm2, <span class="at">graph =</span> <span class="cn">FALSE</span>, <span class="at">min =</span> <span class="dv">3</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>cah_fm2 <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2"></a>  factoextra<span class="sc">::</span><span class="fu">fviz_dend</span>(<span class="at">show_labels =</span> <span class="cn">FALSE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-fviz_dend-dendrogram-cah_fm2" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-fviz_dend-dendrogram-cah_fm2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-fviz_dend-dendrogram-cah_fm2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" data-glightbox="description: .lightbox-desc-11"><img src="classification-ascendante-hierarchique_files/figure-html/fig-fviz_dend-dendrogram-cah_fm2-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-fviz_dend-dendrogram-cah_fm2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.10: Représentation graphique du dendrogramme issu de l’ACM réalisée avec FactoMineR avec prise en compte de l’ensemble des axes
</figcaption></figure>
</div>
</div>
</div>
<p>Nous retrouvons alors le même résultat que celui obtenu avec <a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a> et un découpage en 5 classes.</p>
<p>À noter que <a href="http://factominer.free.fr">FactoMineR</a> propose une visualisation en 3 dimensions du dendrogramme projeté sur le plan factoriel.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>cah_fm2 <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">plot</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-plot-cah_fm2" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-plot-cah_fm2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-plot-cah_fm2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" data-glightbox="description: .lightbox-desc-12"><img src="classification-ascendante-hierarchique_files/figure-html/fig-plot-cah_fm2-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-plot-cah_fm2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.11: Représentation en 3 dimensions du dendrogramme sur le plan factoriel
</figcaption></figure>
</div>
</div>
</div>
<p>Notons également l’option <code>choice = "tree"</code> qui propose une représentation du dendrogramme, avec des rectangles indiquant le découpage optimal et une vignette présentant l’inertie à chaque découpage.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>cah_fm2 <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">plot</span>(<span class="at">choice =</span> <span class="st">"tree"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-plot-cah_fm2-tree" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-plot-cah_fm2-tree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-plot-cah_fm2-tree-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" data-glightbox="description: .lightbox-desc-13"><img src="classification-ascendante-hierarchique_files/figure-html/fig-plot-cah_fm2-tree-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-plot-cah_fm2-tree-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.12: Représentation du dendrogramme et de l’inertie
</figcaption></figure>
</div>
</div>
</div>
<p>Pour récupérer la classification, on pourra récupérer la colonne <code>$clust</code> du sous-objet <code>$data.clust</code> du résultat renvoyé par <code><a href="https://rdrr.io/pkg/FactoMineR/man/HCPC.html">FactoMineR::HCPC()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>hdv2003<span class="sc">$</span>typo_cah_fm2 <span class="ot">&lt;-</span> cah_fm2<span class="sc">$</span>data.clust<span class="sc">$</span>clust</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si l’on a besoin de découper le dendrogramme à un autre endroit, nous pouvons récupérer le dendrogramme via le sous-objet <code>$call$t$tree</code> puis lui appliquer <code><a href="https://rdrr.io/r/stats/cutree.html">cutree()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>hdv2003<span class="sc">$</span>typo_alternative <span class="ot">&lt;-</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>  cah_fm2<span class="sc">$</span>call<span class="sc">$</span>t<span class="sc">$</span>tree <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">cutree</span>(<span class="dv">3</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="caractériser-la-typologie" class="level2 page-columns page-full" data-number="41.5"><h2 data-number="41.5" class="anchored" data-anchor-id="caractériser-la-typologie">
<span class="header-section-number">41.5</span> Caractériser la typologie</h2>
<p>Reste le travail le plus important (et parfois le plus difficile) qui consiste à catégoriser la typologie obtenue et le cas échéant à nommer les classes.</p>
<p>En premier lieu, on peut croiser la typologie obtenue avec les différentes variables inclues dans l’ACM. Le plus simple est d’avoir recours à <code><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_summary.html">gtsummary::tbl_summary()</a></code>. Par exemple, pour la typologie obtenue avec la distance de Gower.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>hdv2003 <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb30-3"><a href="#cb30-3"></a>    <span class="at">include =</span> hard.rock<span class="sc">:</span>sport,</span>
<span id="cb30-4"><a href="#cb30-4"></a>    <span class="at">by =</span> typo_gower_4classes</span>
<span id="cb30-5"><a href="#cb30-5"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb30-6"><a href="#cb30-6"></a>  <span class="fu">bold_labels</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tbl_summary-by-typo_gower_4classes" class="cell quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-tbl_summary-by-typo_gower_4classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="ofxhtzejjn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ofxhtzejjn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ofxhtzejjn thead, #ofxhtzejjn tbody, #ofxhtzejjn tfoot, #ofxhtzejjn tr, #ofxhtzejjn td, #ofxhtzejjn th {
  border-style: none;
}

#ofxhtzejjn p {
  margin: 0;
  padding: 0;
}

#ofxhtzejjn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ofxhtzejjn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ofxhtzejjn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ofxhtzejjn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ofxhtzejjn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ofxhtzejjn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ofxhtzejjn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ofxhtzejjn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ofxhtzejjn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ofxhtzejjn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ofxhtzejjn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ofxhtzejjn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ofxhtzejjn .gt_spanner_row {
  border-bottom-style: hidden;
}

#ofxhtzejjn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ofxhtzejjn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ofxhtzejjn .gt_from_md > :first-child {
  margin-top: 0;
}

#ofxhtzejjn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ofxhtzejjn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ofxhtzejjn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ofxhtzejjn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ofxhtzejjn .gt_row_group_first td {
  border-top-width: 2px;
}

#ofxhtzejjn .gt_row_group_first th {
  border-top-width: 2px;
}

#ofxhtzejjn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ofxhtzejjn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ofxhtzejjn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ofxhtzejjn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ofxhtzejjn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ofxhtzejjn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ofxhtzejjn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ofxhtzejjn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ofxhtzejjn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ofxhtzejjn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ofxhtzejjn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ofxhtzejjn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ofxhtzejjn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ofxhtzejjn .gt_left {
  text-align: left;
}

#ofxhtzejjn .gt_center {
  text-align: center;
}

#ofxhtzejjn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ofxhtzejjn .gt_font_normal {
  font-weight: normal;
}

#ofxhtzejjn .gt_font_bold {
  font-weight: bold;
}

#ofxhtzejjn .gt_font_italic {
  font-style: italic;
}

#ofxhtzejjn .gt_super {
  font-size: 65%;
}

#ofxhtzejjn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ofxhtzejjn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ofxhtzejjn .gt_indent_1 {
  text-indent: 5px;
}

#ofxhtzejjn .gt_indent_2 {
  text-indent: 10px;
}

#ofxhtzejjn .gt_indent_3 {
  text-indent: 15px;
}

#ofxhtzejjn .gt_indent_4 {
  text-indent: 20px;
}

#ofxhtzejjn .gt_indent_5 {
  text-indent: 25px;
}

#ofxhtzejjn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ofxhtzejjn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead><tr class="header gt_col_headings">
<th id="<div data-qmd-base64=&quot;KipDYXJhY3TDqXJpc3RpcXVlKio=&quot;><div class='gt_from_md'><p><strong>Caractéristique</strong></p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><p><strong>Caractéristique</strong></p></th>
<th id="<div data-qmd-base64=&quot;KioxKiogIApOID0gODM3&quot;><div class='gt_from_md'><p><strong>1</strong><br />
N = 837</p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<p><strong>1</strong><br>
N = 837</p>
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span>
</th>
<th id="<div data-qmd-base64=&quot;KioyKiogIApOID0gNjM2&quot;><div class='gt_from_md'><p><strong>2</strong><br />
N = 636</p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<p><strong>2</strong><br>
N = 636</p>
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span>
</th>
<th id="<div data-qmd-base64=&quot;KiozKiogIApOID0gMTcy&quot;><div class='gt_from_md'><p><strong>3</strong><br />
N = 172</p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<p><strong>3</strong><br>
N = 172</p>
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span>
</th>
<th id="<div data-qmd-base64=&quot;Kio0KiogIApOID0gMzU1&quot;><div class='gt_from_md'><p><strong>4</strong><br />
N = 355</p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<p><strong>4</strong><br>
N = 355</p>
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span>
</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">hard.rock</td>
<td class="gt_row gt_center" headers="stat_1"><br></td>
<td class="gt_row gt_center" headers="stat_2"><br></td>
<td class="gt_row gt_center" headers="stat_3"><br></td>
<td class="gt_row gt_center" headers="stat_4"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Non</td>
<td class="gt_row gt_center" headers="stat_1">837 (100%)</td>
<td class="gt_row gt_center" headers="stat_2">632 (99%)</td>
<td class="gt_row gt_center" headers="stat_3">171 (99%)</td>
<td class="gt_row gt_center" headers="stat_4">346 (97%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Oui</td>
<td class="gt_row gt_center" headers="stat_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2">4 (0,6%)</td>
<td class="gt_row gt_center" headers="stat_3">1 (0,6%)</td>
<td class="gt_row gt_center" headers="stat_4">9 (2,5%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">lecture.bd</td>
<td class="gt_row gt_center" headers="stat_1"><br></td>
<td class="gt_row gt_center" headers="stat_2"><br></td>
<td class="gt_row gt_center" headers="stat_3"><br></td>
<td class="gt_row gt_center" headers="stat_4"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Non</td>
<td class="gt_row gt_center" headers="stat_1">813 (97%)</td>
<td class="gt_row gt_center" headers="stat_2">613 (96%)</td>
<td class="gt_row gt_center" headers="stat_3">172 (100%)</td>
<td class="gt_row gt_center" headers="stat_4">355 (100%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Oui</td>
<td class="gt_row gt_center" headers="stat_1">24 (2,9%)</td>
<td class="gt_row gt_center" headers="stat_2">23 (3,6%)</td>
<td class="gt_row gt_center" headers="stat_3">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_4">0 (0%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">peche.chasse</td>
<td class="gt_row gt_center" headers="stat_1"><br></td>
<td class="gt_row gt_center" headers="stat_2"><br></td>
<td class="gt_row gt_center" headers="stat_3"><br></td>
<td class="gt_row gt_center" headers="stat_4"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Non</td>
<td class="gt_row gt_center" headers="stat_1">806 (96%)</td>
<td class="gt_row gt_center" headers="stat_2">633 (100%)</td>
<td class="gt_row gt_center" headers="stat_3">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_4">337 (95%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Oui</td>
<td class="gt_row gt_center" headers="stat_1">31 (3,7%)</td>
<td class="gt_row gt_center" headers="stat_2">3 (0,5%)</td>
<td class="gt_row gt_center" headers="stat_3">172 (100%)</td>
<td class="gt_row gt_center" headers="stat_4">18 (5,1%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">cuisine</td>
<td class="gt_row gt_center" headers="stat_1"><br></td>
<td class="gt_row gt_center" headers="stat_2"><br></td>
<td class="gt_row gt_center" headers="stat_3"><br></td>
<td class="gt_row gt_center" headers="stat_4"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Non</td>
<td class="gt_row gt_center" headers="stat_1">532 (64%)</td>
<td class="gt_row gt_center" headers="stat_2">316 (50%)</td>
<td class="gt_row gt_center" headers="stat_3">79 (46%)</td>
<td class="gt_row gt_center" headers="stat_4">192 (54%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Oui</td>
<td class="gt_row gt_center" headers="stat_1">305 (36%)</td>
<td class="gt_row gt_center" headers="stat_2">320 (50%)</td>
<td class="gt_row gt_center" headers="stat_3">93 (54%)</td>
<td class="gt_row gt_center" headers="stat_4">163 (46%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">bricol</td>
<td class="gt_row gt_center" headers="stat_1"><br></td>
<td class="gt_row gt_center" headers="stat_2"><br></td>
<td class="gt_row gt_center" headers="stat_3"><br></td>
<td class="gt_row gt_center" headers="stat_4"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Non</td>
<td class="gt_row gt_center" headers="stat_1">570 (68%)</td>
<td class="gt_row gt_center" headers="stat_2">317 (50%)</td>
<td class="gt_row gt_center" headers="stat_3">47 (27%)</td>
<td class="gt_row gt_center" headers="stat_4">213 (60%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Oui</td>
<td class="gt_row gt_center" headers="stat_1">267 (32%)</td>
<td class="gt_row gt_center" headers="stat_2">319 (50%)</td>
<td class="gt_row gt_center" headers="stat_3">125 (73%)</td>
<td class="gt_row gt_center" headers="stat_4">142 (40%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">cinema</td>
<td class="gt_row gt_center" headers="stat_1"><br></td>
<td class="gt_row gt_center" headers="stat_2"><br></td>
<td class="gt_row gt_center" headers="stat_3"><br></td>
<td class="gt_row gt_center" headers="stat_4"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Non</td>
<td class="gt_row gt_center" headers="stat_1">831 (99%)</td>
<td class="gt_row gt_center" headers="stat_2">226 (36%)</td>
<td class="gt_row gt_center" headers="stat_3">115 (67%)</td>
<td class="gt_row gt_center" headers="stat_4">2 (0,6%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Oui</td>
<td class="gt_row gt_center" headers="stat_1">6 (0,7%)</td>
<td class="gt_row gt_center" headers="stat_2">410 (64%)</td>
<td class="gt_row gt_center" headers="stat_3">57 (33%)</td>
<td class="gt_row gt_center" headers="stat_4">353 (99%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">sport</td>
<td class="gt_row gt_center" headers="stat_1"><br></td>
<td class="gt_row gt_center" headers="stat_2"><br></td>
<td class="gt_row gt_center" headers="stat_3"><br></td>
<td class="gt_row gt_center" headers="stat_4"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Non</td>
<td class="gt_row gt_center" headers="stat_1">834 (100%)</td>
<td class="gt_row gt_center" headers="stat_2">2 (0,3%)</td>
<td class="gt_row gt_center" headers="stat_3">86 (50%)</td>
<td class="gt_row gt_center" headers="stat_4">355 (100%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Oui</td>
<td class="gt_row gt_center" headers="stat_1">3 (0,4%)</td>
<td class="gt_row gt_center" headers="stat_2">634 (100%)</td>
<td class="gt_row gt_center" headers="stat_3">86 (50%)</td>
<td class="gt_row gt_center" headers="stat_4">0 (0%)</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr class="even">
<td colspan="5" class="gt_footnote">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span>
<p>n (%)</p>
</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-tbl_summary-by-typo_gower_4classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;41.3: Description de la typologie en 4 classes à partir de la distance de Gower
</figcaption></figure>
</div>
</div>
<p>Pour une représentation plus visuelle, on peut également avoir recours à <code><a href="https://ggobi.github.io/ggally/reference/ggtable.html">GGally::ggtable()</a></code> de <a href="https://ggobi.github.io/ggally/">GGally</a> pour représenter les résidus du Chi² et mieux repérer les différences. La couleur bleue indique que la modalité est sur-représentée et la couleur rouge qu’elle est sous-représentée.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb31-2"><a href="#cb31-2"></a>hdv2003<span class="sc">$</span>typo_gower_4classes <span class="ot">&lt;-</span> <span class="fu">factor</span>(hdv2003<span class="sc">$</span>typo_gower_4classes)</span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="fu">ggtable</span>(</span>
<span id="cb31-4"><a href="#cb31-4"></a>  hdv2003, </span>
<span id="cb31-5"><a href="#cb31-5"></a>  <span class="at">columnsX =</span> <span class="st">"typo_gower_4classes"</span>, </span>
<span id="cb31-6"><a href="#cb31-6"></a>  <span class="at">columnsY =</span> <span class="fu">names</span>(d),</span>
<span id="cb31-7"><a href="#cb31-7"></a>  <span class="at">cells =</span> <span class="st">"col.prop"</span>,</span>
<span id="cb31-8"><a href="#cb31-8"></a>  <span class="at">fill =</span> <span class="st">"std.resid"</span></span>
<span id="cb31-9"><a href="#cb31-9"></a>) <span class="sc">+</span> </span>
<span id="cb31-10"><a href="#cb31-10"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Résidus standardizés du Chi²"</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-ggtable-typo_gower_4classes" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-ggtable-typo_gower_4classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-ggtable-typo_gower_4classes-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" data-glightbox="description: .lightbox-desc-14"><img src="classification-ascendante-hierarchique_files/figure-html/fig-ggtable-typo_gower_4classes-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-ggtable-typo_gower_4classes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.13: Distribution de la typologie en 4 classes et résidus du Chi²
</figcaption></figure>
</div>
</div>
</div>
<p>Une première lecture nous indique que&nbsp;:</p>
<ul>
<li><p>la première classe rassemble des individus qui n’ont pas (ou peu) de loisirs&nbsp;;</p></li>
<li><p>la seconde classe réunit des personnes pratiquant un sport et ayant souvent une autre activité telle que le cinéma, la bricolage ou la cuisine&nbsp;;</p></li>
<li><p>la troisième classe réunit spécifiquement les individus pratiquant la chasse ou la pêche&nbsp;;</p></li>
<li><p>la quatrième classe correspond à des personnes ne pratiquant pas de sport mais allant au cinéma.</p></li>
</ul>
<p>Bien sûr, l’interprétation fine des catégories nécessite un peu plus d’analyse, de croiser avec la littérature et les hypothèses des questions de recherche posées, et de croiser la typologie avec d’autres variables de l’enquête.</p>
<p>Pour la typologie réalisée à partir d’une ACM, nous pourrons procéder de la même manière. Cependant, si la CAH a été réalisée avec <code><a href="https://rdrr.io/pkg/FactoMineR/man/HCPC.html">FactoMineR::HCPC()</a></code>, l’objet retourné contient directement un sous-objet <code>$desc.var</code> donnant une description de la typologie obtenue.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>cah_fm2<span class="sc">$</span>desc.var</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Link between the cluster variable and the categorical variables (chi-square test)
=================================================================================
                  p.value df
hard.rock    0.000000e+00  4
lecture.bd   0.000000e+00  4
peche.chasse 0.000000e+00  4
cinema       0.000000e+00  4
sport        1.122743e-38  4
bricol       4.121835e-11  4
cuisine      8.681152e-04  4

Description of each cluster by the categories
=============================================
$`1`
                               Cla/Mod   Mod/Cla Global      p.value     v.test
cinema=cinema_Non             86.03066 100.00000  58.70 0.000000e+00        Inf
peche.chasse=peche.chasse_Non 56.86937 100.00000  88.80 2.188843e-75  18.372312
sport=sport_Non               61.39389  77.62376  63.85 6.009360e-39  13.054257
lecture.bd=lecture.bd_Non     51.71531 100.00000  97.65 2.518852e-15   7.912690
bricol=bricol_Non             57.10549  64.85149  57.35 6.993497e-12   6.857788
cuisine=cuisine_Non           54.60232  60.49505  55.95 3.566198e-05   4.133925
hard.rock=hard.rock_Non       50.85599 100.00000  99.30 5.060286e-05   4.052825
hard.rock=hard.rock_Oui        0.00000   0.00000   0.70 5.060286e-05  -4.052825
cuisine=cuisine_Oui           45.28944  39.50495  44.05 3.566198e-05  -4.133925
bricol=bricol_Oui             41.61782  35.14851  42.65 6.993497e-12  -6.857788
lecture.bd=lecture.bd_Oui      0.00000   0.00000   2.35 2.518852e-15  -7.912690
sport=sport_Oui               31.25864  22.37624  36.15 6.009360e-39 -13.054257
peche.chasse=peche.chasse_Oui  0.00000   0.00000  11.20 2.188843e-75 -18.372312
cinema=cinema_Oui              0.00000   0.00000  41.30 0.000000e+00       -Inf

$`2`
                                Cla/Mod   Mod/Cla Global       p.value
peche.chasse=peche.chasse_Oui 96.428571 100.00000  11.20 2.257673e-282
bricol=bricol_Oui             14.536928  57.40741  42.65  4.149911e-06
lecture.bd=lecture.bd_Non     11.059908 100.00000  97.65  4.347616e-03
cinema=cinema_Non             12.265758  66.66667  58.70  1.129267e-02
cinema=cinema_Oui              8.716707  33.33333  41.30  1.129267e-02
lecture.bd=lecture.bd_Oui      0.000000   0.00000   2.35  4.347616e-03
bricol=bricol_Non              8.020924  42.59259  57.35  4.149911e-06
peche.chasse=peche.chasse_Non  0.000000   0.00000  88.80 2.257673e-282
                                  v.test
peche.chasse=peche.chasse_Oui  35.908415
bricol=bricol_Oui               4.603730
lecture.bd=lecture.bd_Non       2.851773
cinema=cinema_Non               2.533509
cinema=cinema_Oui              -2.533509
lecture.bd=lecture.bd_Oui      -2.851773
bricol=bricol_Non              -4.603730
peche.chasse=peche.chasse_Non -35.908415

$`3`
                               Cla/Mod   Mod/Cla Global      p.value     v.test
cinema=cinema_Oui             86.31961 100.00000  41.30 0.000000e+00        Inf
peche.chasse=peche.chasse_Non 40.14640 100.00000  88.80 6.154083e-47  14.388011
sport=sport_Oui               52.97372  53.71669  36.15 1.222033e-33  12.088015
lecture.bd=lecture.bd_Non     36.50794 100.00000  97.65 7.397824e-10   6.157337
bricol=bricol_Oui             40.21102  48.10659  42.65 2.493205e-04   3.662957
cuisine=cuisine_Oui           39.38706  48.66760  44.05 2.003812e-03   3.089667
hard.rock=hard.rock_Non       35.90131 100.00000  99.30 2.035491e-03   3.085005
hard.rock=hard.rock_Oui        0.00000   0.00000   0.70 2.035491e-03  -3.085005
cuisine=cuisine_Non           32.70777  51.33240  55.95 2.003812e-03  -3.089667
bricol=bricol_Non             32.25806  51.89341  57.35 2.493205e-04  -3.662957
lecture.bd=lecture.bd_Oui      0.00000   0.00000   2.35 7.397824e-10  -6.157337
sport=sport_Non               25.84182  46.28331  63.85 1.222033e-33 -12.088015
peche.chasse=peche.chasse_Oui  0.00000   0.00000  11.20 6.154083e-47 -14.388011
cinema=cinema_Non              0.00000   0.00000  58.70 0.000000e+00       -Inf

$`4`
                             Cla/Mod   Mod/Cla Global      p.value     v.test
lecture.bd=lecture.bd_Oui 100.000000 100.00000   2.35 3.168360e-96  20.814956
cinema=cinema_Oui           3.510896  61.70213  41.30 4.803168e-03   2.819946
sport=sport_Oui             3.319502  51.06383  36.15 3.601926e-02   2.096710
sport=sport_Non             1.801096  48.93617  63.85 3.601926e-02  -2.096710
cinema=cinema_Non           1.533220  38.29787  58.70 4.803168e-03  -2.819946
lecture.bd=lecture.bd_Non   0.000000   0.00000  97.65 3.168360e-96 -20.814956

$`5`
                            Cla/Mod   Mod/Cla Global      p.value     v.test
hard.rock=hard.rock_Oui 100.0000000 100.00000    0.7 5.569208e-36  12.523271
cinema=cinema_Oui         1.4527845  85.71429   41.3 9.122223e-04   3.316287
cinema=cinema_Non         0.1703578  14.28571   58.7 9.122223e-04  -3.316287
hard.rock=hard.rock_Non   0.0000000   0.00000   99.3 5.569208e-36 -12.523271</code></pre>
</div>
</div>
<p>Une représentation graphique indiquant les modalités contribuant le plus à chaque axe est même directement disponible. La couleur bleue indique que la modalité est sous-représentée dans la classe et la couleur rouge qu’elle est sur-représentée<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn11"><p><sup>11</sup>&nbsp;<strong>Attention à l’interprétation&nbsp;:</strong> ce code couleur est l’inverse de celui utilisé par <code><a href="https://ggobi.github.io/ggally/reference/ggtable.html">GGally::ggtable()</a></code>.</p></div></div><div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>cah_fm2<span class="sc">$</span>desc.var <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-cah_fm2-desc.var-plot" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-cah_fm2-desc.var-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="classification-ascendante-hierarchique_files/figure-html/fig-cah_fm2-desc.var-plot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" data-glightbox="description: .lightbox-desc-15"><img src="classification-ascendante-hierarchique_files/figure-html/fig-cah_fm2-desc.var-plot-1.png" class="img-fluid figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-cah_fm2-desc.var-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;41.14: Représentation graphique des modalités contribuant le plus
</figcaption></figure>
</div>
</div>
</div>
</section><section id="webin-r" class="level2" data-number="41.6"><h2 data-number="41.6" class="anchored" data-anchor-id="webin-r">
<span class="header-section-number">41.6</span> webin-R</h2>
<p>La CAH est présentée sur YouTube dans le <a href="https://youtu.be/Q8adb64NzUI">webin-R #12</a> (<em>Classification Ascendante Hiérarchique</em>).</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/Q8adb64NzUI" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Figure&nbsp;41.1: Représentation graphique du dendrogramme avec plot()</span>
<span class="glightbox-desc lightbox-desc-2">Figure&nbsp;41.2: Représentation graphique du dendrogramme avec fviz_dend()</span>
<span class="glightbox-desc lightbox-desc-3">Figure&nbsp;41.3: Représentation graphique du dendrogramme avec fviz_dend()</span>
<span class="glightbox-desc lightbox-desc-4">Figure&nbsp;41.4: Inertie, perte absolue et perte relative d’inertie pour différents découpages en classes (distance de Gower)</span>
<span class="glightbox-desc lightbox-desc-5">Figure&nbsp;41.5: Représentation graphique du dendrogramme issu de l’ACM</span>
<span class="glightbox-desc lightbox-desc-6">Figure&nbsp;41.6: Inertie, perte absolue et perte relative d’inertie pour différents découpages en classes (distance de Phi²)</span>
<span class="glightbox-desc lightbox-desc-7">Figure&nbsp;41.7: Projection de la typologie dans le plan factoriel de l’ACM</span>
<span class="glightbox-desc lightbox-desc-9">Figure&nbsp;41.8: Représentation graphique du dendrogramme issu de l’ACM réalisée avec FactoMineR</span>
<span class="glightbox-desc lightbox-desc-10">Figure&nbsp;41.9: Inertie, perte absolue et perte relative d’inertie pour différents découpages en classes à partir du résultat de HCPC()</span>
<span class="glightbox-desc lightbox-desc-11">Figure&nbsp;41.10: Représentation graphique du dendrogramme issu de l’ACM réalisée avec FactoMineR avec prise en compte de l’ensemble des axes</span>
<span class="glightbox-desc lightbox-desc-12">Figure&nbsp;41.11: Représentation en 3 dimensions du dendrogramme sur le plan factoriel</span>
<span class="glightbox-desc lightbox-desc-13">Figure&nbsp;41.12: Représentation du dendrogramme et de l’inertie</span>
<span class="glightbox-desc lightbox-desc-14">Figure&nbsp;41.13: Distribution de la typologie en 4 classes et résidus du Chi²</span>
<span class="glightbox-desc lightbox-desc-15">Figure&nbsp;41.14: Représentation graphique des modalités contribuant le plus</span>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="larmarange/guide-R" data-repo-id="R_kgDOH6-xnw" data-category="Forum" data-category-id="DIC_kwDOH6-xn84CRLQy" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="fr" crossorigin="anonymous" data-loading="lazy" async="">
</script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../analyses_avancees/analyse-factorielle.html" class="pagination-link" aria-label="Analyse factorielle">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Analyse factorielle</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../analyses_avancees/analyse-survie.html" class="pagination-link" aria-label="Analyse de survie">
        <span class="nav-page-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Analyse de survie</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
 guide-R : Guide pour l'analyse de données d'enquêtes avec R
  </li>  
</ul>
</div>   
    <div class="nav-footer-center">

<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/larmarange/guide-R/blob/main/analyses_avancees/classification-ascendante-hierarchique.qmd" class="toc-action"><i class="bi bi-github"></i>Voir la source</a></li><li><a href="https://github.com/larmarange/guide-R/issues/new" class="toc-action"><i class="bi empty"></i>Faire part d'un problème</a></li></ul></div><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
      <i class="bi bi-badge-cc-fill" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/larmarange/guide-R/" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/c/webinR">
      <i class="bi bi-youtube" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://larmarange.github.io/analyse-R/">
<p>analyse-R</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://larmarange.github.io/webin-R/">
<p>webin-R</p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"loop":false,"openEffect":"zoom","selector":".lightbox","descPosition":"bottom","closeEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>


<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>