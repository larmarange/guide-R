<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>guide-R - 43&nbsp; Modèles de comptage (Poisson &amp; apparentés)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../analyses_avancees/modeles-incidence.html" rel="next">
<link href="../analyses_avancees/regression-logistique-ordinale.html" rel="prev">
<link href="../ressources/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-8BT7D9P85Y"></script><script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-8BT7D9P85Y', { 'anonymize_ip': true});
</script><script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"fr"
  });
});
</script><style>html{ scroll-behavior: smooth; }</style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../analyses_avancees/analyse-factorielle.html"><strong>Analyses avancées</strong></a></li><li class="breadcrumb-item"><a href="../analyses_avancees/modeles-comptage.html"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Modèles de comptage (Poisson &amp; apparentés)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../ressources/typewriter.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">guide-R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/larmarange/guide-R/" title="Code source" class="quarto-navigation-tool px-1" aria-label="Code source"><i class="bi bi-github"></i></a>
    <a href="../guide-R.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
    <div id="quarto-search" class="quarto-navigation-tool px-1" title="Recherche"></div>
</div>
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Préface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text"><strong>Bases du langage</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bases/packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bases/vecteurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Vecteurs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bases/listes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Listes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bases/tableaux_donnees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tableaux de données</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bases/tibbles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tibbles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bases/attributs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Attributs</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text"><strong>Manipulation de données</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/pipe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Le pipe</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/facteurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Facteurs et <code>forcats</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/combiner-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Combiner plusieurs variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/etiquettes-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Étiquettes de variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/etiquettes-valeurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Étiquettes de valeurs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/valeurs-manquantes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Valeurs manquantes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/import-export.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Import &amp; Export de données</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/formater-nombre.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Mettre en forme des nombres</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation/couleurs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Couleurs &amp; Palettes</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text"><strong>Analyses</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Graphiques avec <code>ggplot2</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/statistique-univariee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Statistique univariée &amp; Intervalles de confiance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/statistique-bivariee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Statistique bivariée &amp; Tests de comparaison</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/likert.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Échelles de Likert</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/regression-lineaire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Régression linéaire</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/regression-logistique-binaire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Régression logistique binaire</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/selection-modele-pas-a-pas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Sélection pas à pas d’un modèle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/estimations-marginales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Prédictions marginales, contrastes marginaux &amp; effets marginaux</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/contrastes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Contrastes (variables catégorielles)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Interactions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses/multicolinearite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Multicolinéarité</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text"><strong>Données pondérées avec <code>survey</code></strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../donnees_ponderees/plan-echantillonnage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Définir un plan d’échantillonnage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../donnees_ponderees/manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Manipulation de données pondérées</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../donnees_ponderees/analyses-bivariees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Analyses uni- et bivariées pondérées</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../donnees_ponderees/graphiques-ponderes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Graphiques pondérés</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../donnees_ponderees/regression-logistique-binaire-ponderee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Régression logistique binaire pondérée</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text"><strong>Manipulation avancée</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation_avancee/fusion_tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Fusion de tables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation_avancee/dates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Dates avec <code>lubridate</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation_avancee/stringr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Chaînes de texte avec <code>stringr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation_avancee/tidyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Réorganisation avec <code>tidyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation_avancee/conditions-logiques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Conditions logiques</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../manipulation_avancee/transformations-multiples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Transformations multiples</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text"><strong>Analyses avancées</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/analyse-factorielle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Analyse factorielle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/classification-ascendante-hierarchique.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Classification ascendante hiérarchique</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/regression-logistique-multinomiale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Régression logistique multinomiale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/regression-logistique-ordinale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Régression logistique ordinale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/modeles-comptage.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Modèles de comptage (Poisson &amp; apparentés)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/modeles-incidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Modèles d’incidence / de taux</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/modeles-zero-inflated.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Modèles de comptage <em>zero-inflated</em> et <em>hurdle</em></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analyses_avancees/choix-modele.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Quel modèle choisir&nbsp;?</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text"><strong>Pour aller plus loin</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../extra/ressources-documentaires.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Ressources documentaires</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table des matières</h2>
   
  <ul>
<li>
<a href="#mod%C3%A8le-de-poisson" id="toc-modèle-de-poisson" class="nav-link active" data-scroll-target="#mod%C3%A8le-de-poisson"><span class="header-section-number">43.1</span> Modèle de Poisson</a>
  <ul class="collapse">
<li><a href="#pr%C3%A9paration-des-donn%C3%A9es-du-premier-exemple" id="toc-préparation-des-données-du-premier-exemple" class="nav-link" data-scroll-target="#pr%C3%A9paration-des-donn%C3%A9es-du-premier-exemple"><span class="header-section-number">43.1.1</span> Préparation des données du premier exemple</a></li>
  <li><a href="#calcul-interpr%C3%A9tation-du-mod%C3%A8le-de-poisson" id="toc-calcul-interprétation-du-modèle-de-poisson" class="nav-link" data-scroll-target="#calcul-interpr%C3%A9tation-du-mod%C3%A8le-de-poisson"><span class="header-section-number">43.1.2</span> Calcul &amp; Interprétation du modèle de Poisson</a></li>
  <li><a href="#sec-evaluation-surdispersion" id="toc-sec-evaluation-surdispersion" class="nav-link" data-scroll-target="#sec-evaluation-surdispersion"><span class="header-section-number">43.1.3</span> Évaluation de la surdispersion</a></li>
  </ul>
</li>
  <li><a href="#mod%C3%A8le-de-quasi-poisson" id="toc-modèle-de-quasi-poisson" class="nav-link" data-scroll-target="#mod%C3%A8le-de-quasi-poisson"><span class="header-section-number">43.2</span> Modèle de quasi-Poisson</a></li>
  <li><a href="#mod%C3%A8le-binomial-n%C3%A9gatif" id="toc-modèle-binomial-négatif" class="nav-link" data-scroll-target="#mod%C3%A8le-binomial-n%C3%A9gatif"><span class="header-section-number">43.3</span> Modèle binomial négatif</a></li>
  <li><a href="#exemple-avec-une-plus-grande-surdispersion" id="toc-exemple-avec-une-plus-grande-surdispersion" class="nav-link" data-scroll-target="#exemple-avec-une-plus-grande-surdispersion"><span class="header-section-number">43.4</span> Exemple avec une plus grande surdispersion</a></li>
  <li><a href="#mod%C3%A8les-de-comptage-avec-une-variable-binaire" id="toc-modèles-de-comptage-avec-une-variable-binaire" class="nav-link" data-scroll-target="#mod%C3%A8les-de-comptage-avec-une-variable-binaire"><span class="header-section-number">43.5</span> Modèles de comptage avec une variable binaire</a></li>
  <li><a href="#donn%C3%A9es-pond%C3%A9r%C3%A9es-et-plan-d%C3%A9chantillonnage" id="toc-données-pondérées-et-plan-déchantillonnage" class="nav-link" data-scroll-target="#donn%C3%A9es-pond%C3%A9r%C3%A9es-et-plan-d%C3%A9chantillonnage"><span class="header-section-number">43.6</span> Données pondérées et plan d’échantillonnage</a></li>
  <li><a href="#lectures-compl%C3%A9mentaires" id="toc-lectures-complémentaires" class="nav-link" data-scroll-target="#lectures-compl%C3%A9mentaires"><span class="header-section-number">43.7</span> Lectures complémentaires</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/larmarange/guide-R/blob/main/analyses_avancees/modeles-comptage.qmd" class="toc-action"><i class="bi bi-github"></i>Voir la source</a></li><li><a href="https://github.com/larmarange/guide-R/issues/new" class="toc-action"><i class="bi empty"></i>Faire part d'un problème</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../analyses_avancees/analyse-factorielle.html"><strong>Analyses avancées</strong></a></li><li class="breadcrumb-item"><a href="../analyses_avancees/modeles-comptage.html"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Modèles de comptage (Poisson &amp; apparentés)</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-modeles-comptage" class="quarto-section-identifier"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Modèles de comptage (Poisson &amp; apparentés)</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Une variable de type <q>comptage</q> correspond à un <em>outcome</em> (variable à expliquer) entier positif. Le plus souvent, il s’agit du nombre d’occurrences de l’évènement d’intérêt. Pour expliquer une variable de ce type, les modèles linéaires ou les régressions logistiques ne sont pas adaptées. On aura alors recours à des modèles ou régressions de <strong>Poisson</strong>, c’est-à-dire de manière plus spécifique à un modèle linéaire généralisé (GLM en anglais), avec une fonction de lien logarithmique et une distribution statistique de <strong>Poisson</strong>.</p>
<p>Les modèles de <strong>Poisson</strong> font l’hypothèse que la variance est égale à la moyenne, ce qui ne s’observe pas toujours. Auquel cas on aura alors un problème de <strong>surdispersion</strong>. Dans ce cas-là, nous pourrons avoir recours à des modèles apparentés aux modèles de Poisson, à savoir les modèles <strong>quasi-Poisson</strong>, les modèles <strong>binomiaux négatifs</strong>.</p>
<p>Les modèles de comptage peuvent aussi être utiliser pour un <em>outcome</em> binaire, en lieu et place d’une régression logistique, afin d’estimer des <em>prevalence ratios</em> plutôt que des <em>odds ratios</em>.</p>
<p>Enfin, lorsqu’il y a un nombre important de 0 dans les données à expliquer, on peut avoir recours à des modèles <em>zero-inflated</em> ou des modèles <em>hurdle</em> qui, d’une certaine manière, combinent deux modèles en un (d’une part la probabilité de vivre l’évènement et d’autre part le nombre d’occurrences de l’évènement).</p>
<section id="modèle-de-poisson" class="level2 page-columns page-full" data-number="43.1"><h2 data-number="43.1" class="anchored" data-anchor-id="modèle-de-poisson">
<span class="header-section-number">43.1</span> Modèle de Poisson</h2>
<p>Nous allons nous intéresser à un premier exemple démographique en nous intéressant à la descendance atteinte par des femmes à l’âge de 30 ans.</p>
<section id="préparation-des-données-du-premier-exemple" class="level3" data-number="43.1.1"><h3 data-number="43.1.1" class="anchored" data-anchor-id="préparation-des-données-du-premier-exemple">
<span class="header-section-number">43.1.1</span> Préparation des données du premier exemple</h3>
<p>Pour cet exemple, nous allons considérer le jeu de données <code>fecondite</code> fourni par le package <a href="https://juba.github.io/questionr/">questionr</a>. Ce jeu de données comprends trois tables de données (<code>menages</code>, <code>femmes</code> et <code>enfants</code>) simulant les résultats d’une enquête démographique et de santé (EDS). Chargeons les données et jetons y un œil avec <code><a href="https://larmarange.github.io/labelled/reference/look_for.html">labelled::look_for()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(labelled)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">data</span>(<span class="st">"fecondite"</span>, <span class="at">package =</span> <span class="st">"questionr"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>enfants <span class="sc">|&gt;</span> <span class="fu">look_for</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> pos variable       label                        col_type missing values      
 1   id_enfant      Identifiant de l'enfant      dbl      0                   
 2   id_femme       Identifiant de la mère       dbl      0                   
 3   date_naissance Date de naissance            date     0                   
 4   sexe           Sexe de l'enfant             dbl+lbl  0       [1] masculin
                                                                  [2] féminin 
 5   survie         L'enfant est-il toujours en~ dbl+lbl  0       [0] non     
                                                                  [1] oui     
 6   age_deces      Age au décès (en mois)       dbl      1442                </code></pre>
</div>
</div>
<p>Comme nous pouvons le voir, les variables catégorielles sont codées sous la forme de vecteurs numériques labellisés (cf. <a href="../manipulation/etiquettes-valeurs.html" class="quarto-xref"><span>Chapitre 12</span></a>), comme cela aurait été le cas si nous avions importé un fichier Stata ou SPSS avec <a href="https://haven.tidyverse.org">haven</a>. Première étape, nous allons convertir <q>à la volée</q> ces variables catégorielles en facteurs avec <code><a href="https://larmarange.github.io/labelled/reference/to_factor.html">labelled::unlabelled()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>femmes <span class="ot">&lt;-</span> </span>
<span id="cb4-2"><a href="#cb4-2"></a>  femmes <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">unlabelled</span>()</span>
<span id="cb4-4"><a href="#cb4-4"></a>enfants <span class="ot">&lt;-</span> </span>
<span id="cb4-5"><a href="#cb4-5"></a>  enfants <span class="sc">|&gt;</span> </span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="fu">unlabelled</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour notre analyse, nous allons devoir compter le nombre d’enfants que chaque femme a eu avant l’âge de 30 ans exacts. En premier lieu, nous devons calculer l’âge (cf. <a href="../manipulation_avancee/dates.html#sec-calcul-age" class="quarto-xref"><span>Section 34.4</span></a>) de la mère à la naissance dans le tableau <code>enfants</code>, à l’aide de la fonction <code><a href="https://lubridate.tidyverse.org/reference/time_length.html">lubridate::time_length()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>enfants <span class="ot">&lt;-</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  enfants <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">left_join</span>(</span>
<span id="cb5-4"><a href="#cb5-4"></a>    femmes <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>      <span class="fu">select</span>(id_femme, <span class="at">date_naissance_mere =</span> date_naissance),</span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="at">by =</span> <span class="st">"id_femme"</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-9"><a href="#cb5-9"></a>    <span class="at">age_mere =</span> <span class="fu">time_length</span>(</span>
<span id="cb5-10"><a href="#cb5-10"></a>      date_naissance_mere <span class="sc">%--%</span> date_naissance,</span>
<span id="cb5-11"><a href="#cb5-11"></a>      <span class="at">unit =</span> <span class="st">"years"</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>    )</span>
<span id="cb5-13"><a href="#cb5-13"></a>  )</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Comptons maintenant, par femme, le nombre d’enfants nés avant l’âge de 30 ans et ajoutons cette valeur à la table <code>femmes</code>. N’oublions, après la fusion, de recoder les valeurs manquantes <code>NA</code> en 0 avec <code><a href="https://tidyr.tidyverse.org/reference/replace_na.html">tidyr::replace_na()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>femmes <span class="ot">&lt;-</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  femmes <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">left_join</span>(</span>
<span id="cb6-4"><a href="#cb6-4"></a>    enfants <span class="sc">|&gt;</span> </span>
<span id="cb6-5"><a href="#cb6-5"></a>      <span class="fu">filter</span>(age_mere <span class="sc">&lt;</span> <span class="dv">30</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6"></a>      <span class="fu">group_by</span>(id_femme) <span class="sc">|&gt;</span> </span>
<span id="cb6-7"><a href="#cb6-7"></a>      <span class="fu">count</span>(<span class="at">name =</span> <span class="st">"enfants_avt_30"</span>),</span>
<span id="cb6-8"><a href="#cb6-8"></a>    <span class="at">by =</span> <span class="st">"id_femme"</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb6-10"><a href="#cb6-10"></a>  tidyr<span class="sc">::</span><span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">enfants_avt_30 =</span> <span class="dv">0</span>L))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il nous reste à calculer l’âge des femmes au moment de l’enquête. Nous allons en profiter pour recoder (cf. <a href="../manipulation/facteurs.html#sec-modifier-modalites" class="quarto-xref"><span>Section 9.3</span></a>) la variable éducation en regroupant les modalités <q>secondaire</q> et <q>supérieur</q>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>femmes <span class="ot">&lt;-</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  femmes <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="at">age =</span> <span class="fu">time_length</span>(</span>
<span id="cb7-5"><a href="#cb7-5"></a>      date_naissance <span class="sc">%--%</span> date_entretien,</span>
<span id="cb7-6"><a href="#cb7-6"></a>      <span class="at">unit =</span> <span class="st">"years"</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>    ),</span>
<span id="cb7-8"><a href="#cb7-8"></a>    <span class="at">educ2 =</span> educ <span class="sc">|&gt;</span> </span>
<span id="cb7-9"><a href="#cb7-9"></a>      <span class="fu">fct_recode</span>(</span>
<span id="cb7-10"><a href="#cb7-10"></a>        <span class="st">"secondaire/supérieur"</span> <span class="ot">=</span> <span class="st">"secondaire"</span>,</span>
<span id="cb7-11"><a href="#cb7-11"></a>        <span class="st">"secondaire/supérieur"</span> <span class="ot">=</span> <span class="st">"supérieur"</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>      )</span>
<span id="cb7-13"><a href="#cb7-13"></a>  )</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Enfin, pour l’analyse, nous n’allons garder que les femmes âgées d’au moins 30 ans au moment de l’enquête. En effet, les femmes plus jeunes n’ayant pas encore atteint 30 ans, nous ne connaissons pas leur descendance atteinte à cet âge.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>femmes30p <span class="ot">&lt;-</span> </span>
<span id="cb8-2"><a href="#cb8-2"></a>  femmes <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">filter</span>(age <span class="sc">&gt;=</span> <span class="dv">30</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="calcul-interprétation-du-modèle-de-poisson" class="level3 page-columns page-full" data-number="43.1.2"><h3 data-number="43.1.2" class="anchored" data-anchor-id="calcul-interprétation-du-modèle-de-poisson">
<span class="header-section-number">43.1.2</span> Calcul &amp; Interprétation du modèle de Poisson</h3>
<p>Les modèles de Poisson font partie de la famille des modèles linéaires généralisés (<em>GLM</em> en anglais) et se calculent dont avec la fonction <code><a href="https://rdrr.io/r/stats/glm.html">stats::glm()</a></code> en précisant <code>family = poisson</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>mod1_poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb9-2"><a href="#cb9-2"></a>  enfants_avt_30 <span class="sc">~</span> educ2 <span class="sc">+</span> milieu <span class="sc">+</span> region,</span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="at">family =</span> poisson,</span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="at">data =</span> femmes30p</span>
<span id="cb9-5"><a href="#cb9-5"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’ensemble des fonctions et méthodes applicables aux modèles GLM, que nous avons déjà abordé dans le chapitre sur la régression logistique (cf. <a href="../analyses/regression-logistique-binaire.html" class="quarto-xref"><span>Chapitre 22</span></a>), peuvent s’appliquer également aux modèles de Poisson. Nous pouvons par exemple réduire notre modèle par minimisation de l’AIC avec <code><a href="https://rdrr.io/r/stats/step.html">stats::step()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>mod1_poisson <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1_poisson)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1013.81
enfants_avt_30 ~ educ2 + milieu + region

         Df Deviance    AIC
- region  3   686.46 1010.6
&lt;none&gt;        683.62 1013.8
- milieu  1   686.84 1015.0
- educ2   2   691.10 1017.3

Step:  AIC=1010.65
enfants_avt_30 ~ educ2 + milieu

         Df Deviance    AIC
&lt;none&gt;        686.46 1010.6
- milieu  1   691.30 1013.5
- educ2   2   693.94 1014.1</code></pre>
</div>
</div>
<p>Par défaut, les modèles de Poisson utilisent une fonction de lien logarithmique (<em>log</em>). Dès lors, il est fréquent de ne pas présenter directement les coefficients du modèle, mais plutôt l’exponentielle de leurs valeurs qui peut s’interpréter comme des <q>risques relatifs</q> (<em>relative risks</em> ou RR<em>)</em><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. L’exponentielle des coefficients peut aussi être appelée <em>incidence rate ratio</em> (IRR) car la régression de Poisson peut également être utilisée pour des modèles d’incidence, qui seront abordés dans le prochain chapitre (cf. <a href="modeles-incidence.html" class="quarto-xref"><span>Chapitre 44</span></a>).</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;À ne pas confondre avec les <em>odds ratio</em> ou OR de la régression logistique.</p></div></div><p>Pour un tableau mis en forme des coefficients, on aura tout simplement recours à <a href="https://github.com/ddsjoberg/gtsummary">gtsummary</a> et sa fonction <code><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_regression.html">gtsummary::tbl_regression()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">theme_gtsummary_language</span>(<span class="st">"fr"</span>, <span class="at">decimal.mark =</span> <span class="st">","</span>, <span class="at">big.mark =</span> <span class="st">" "</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting theme `language: fr`</code></pre>
</div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>mod1_poisson <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">tbl_regression</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">bold_labels</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-regression-poisson" class="cell quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-regression-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="voxrbdbrnb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#voxrbdbrnb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#voxrbdbrnb thead, #voxrbdbrnb tbody, #voxrbdbrnb tfoot, #voxrbdbrnb tr, #voxrbdbrnb td, #voxrbdbrnb th {
  border-style: none;
}

#voxrbdbrnb p {
  margin: 0;
  padding: 0;
}

#voxrbdbrnb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#voxrbdbrnb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#voxrbdbrnb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#voxrbdbrnb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#voxrbdbrnb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#voxrbdbrnb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#voxrbdbrnb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#voxrbdbrnb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#voxrbdbrnb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#voxrbdbrnb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#voxrbdbrnb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#voxrbdbrnb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#voxrbdbrnb .gt_spanner_row {
  border-bottom-style: hidden;
}

#voxrbdbrnb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#voxrbdbrnb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#voxrbdbrnb .gt_from_md > :first-child {
  margin-top: 0;
}

#voxrbdbrnb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#voxrbdbrnb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#voxrbdbrnb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#voxrbdbrnb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#voxrbdbrnb .gt_row_group_first td {
  border-top-width: 2px;
}

#voxrbdbrnb .gt_row_group_first th {
  border-top-width: 2px;
}

#voxrbdbrnb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#voxrbdbrnb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#voxrbdbrnb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#voxrbdbrnb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#voxrbdbrnb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#voxrbdbrnb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#voxrbdbrnb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#voxrbdbrnb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#voxrbdbrnb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#voxrbdbrnb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#voxrbdbrnb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#voxrbdbrnb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#voxrbdbrnb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#voxrbdbrnb .gt_left {
  text-align: left;
}

#voxrbdbrnb .gt_center {
  text-align: center;
}

#voxrbdbrnb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#voxrbdbrnb .gt_font_normal {
  font-weight: normal;
}

#voxrbdbrnb .gt_font_bold {
  font-weight: bold;
}

#voxrbdbrnb .gt_font_italic {
  font-style: italic;
}

#voxrbdbrnb .gt_super {
  font-size: 65%;
}

#voxrbdbrnb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#voxrbdbrnb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#voxrbdbrnb .gt_indent_1 {
  text-indent: 5px;
}

#voxrbdbrnb .gt_indent_2 {
  text-indent: 10px;
}

#voxrbdbrnb .gt_indent_3 {
  text-indent: 15px;
}

#voxrbdbrnb .gt_indent_4 {
  text-indent: 20px;
}

#voxrbdbrnb .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead><tr class="header gt_col_headings">
<th id="<strong>Caractéristique</strong>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Caractéristique</strong></th>
<th id="<strong>IRR</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>IRR</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
<th id="<strong>95% IC</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>95% IC</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
<th id="<strong>p-valeur</strong>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-valeur</strong></th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Niveau d'éducation</td>
<td class="gt_row gt_center" headers="estimate"><br></td>
<td class="gt_row gt_center" headers="ci"><br></td>
<td class="gt_row gt_center" headers="p.value"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;aucun</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="ci">—</td>
<td class="gt_row gt_center" headers="p.value"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;primaire</td>
<td class="gt_row gt_center" headers="estimate">1,25</td>
<td class="gt_row gt_center" headers="ci">0,90 – 1,72</td>
<td class="gt_row gt_center" headers="p.value">0,2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;secondaire/supérieur</td>
<td class="gt_row gt_center" headers="estimate">0,53</td>
<td class="gt_row gt_center" headers="ci">0,27 – 0,96</td>
<td class="gt_row gt_center" headers="p.value">0,052</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Milieu de résidence</td>
<td class="gt_row gt_center" headers="estimate"><br></td>
<td class="gt_row gt_center" headers="ci"><br></td>
<td class="gt_row gt_center" headers="p.value"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;urbain</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="ci">—</td>
<td class="gt_row gt_center" headers="p.value"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;rural</td>
<td class="gt_row gt_center" headers="estimate">1,42</td>
<td class="gt_row gt_center" headers="ci">1,04 – 1,98</td>
<td class="gt_row gt_center" headers="p.value">0,032</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr class="even">
<td colspan="4" class="gt_footnote">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> IRR = rapport de taux d’incidence, IC = intervalle de confiance</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-regression-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;43.1: Tableau des coefficients du modèle de Poisson
</figcaption></figure>
</div>
</div>
<p>Pour une représentation graphique, on pourra avoir recours à <code><a href="https://larmarange.github.io/ggstats/reference/ggcoef_model.html">ggstats::ggcoef_model()</a></code> ou <code><a href="https://larmarange.github.io/ggstats/reference/ggcoef_model.html">ggstats::ggcoef_table()</a></code>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">library</span>(ggstats)</span>
<span id="cb15-2"><a href="#cb15-2"></a>mod1_poisson <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">ggcoef_table</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-ggcoef_table-regression-poisson" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-ggcoef_table-regression-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="modeles-comptage_files/figure-html/fig-ggcoef_table-regression-poisson-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-1" data-gallery="quarto-lightbox-gallery-1"><img src="modeles-comptage_files/figure-html/fig-ggcoef_table-regression-poisson-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-ggcoef_table-regression-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43.1: Forest plot des coefficients du modèle de Poisson
</figcaption></figure>
</div>
</div>
</div>
<p>Pour interpréter les coefficients, il faut se rappeler que ce qui est modélisé dans le modèle de Poisson est le nombre moyen d’évènements. Le RR pour la modalité <q>secondaire/supérieur</q> est de 0,5&nbsp;: cela signifie donc que, indépendamment des autres variables du modèle, la descendance atteinte à 30 ans moyenne des femmes de niveau secondaire ou supérieure est moitié moindre que celle des femmes sans niveau d’éducation (modalité de référence).</p>
<p>Nous pouvons vérifier visuellement ce résultat en réalisant un graphique des prédictions marginales moyennes avec <code><a href="https://larmarange.github.io/broom.helpers/reference/tidy_marginal_predictions.html">broom.helpers::plot_marginal_predictions()</a></code> (cf. <a href="../analyses/estimations-marginales.html#sec-predictions-marginales" class="quarto-xref"><span>Section 24.3</span></a>).</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>broom.helpers<span class="sc">::</span><span class="fu">plot_marginal_predictions</span>(mod1_poisson) <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>() <span class="sc">&amp;</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">4</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-predictions-marginales-regression-poisson" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-predictions-marginales-regression-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="modeles-comptage_files/figure-html/fig-predictions-marginales-regression-poisson-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="quarto-lightbox-gallery-2"><img src="modeles-comptage_files/figure-html/fig-predictions-marginales-regression-poisson-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-predictions-marginales-regression-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43.2: Prédictions marginales du modèle de Poisson
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-evaluation-surdispersion" class="level3 page-columns page-full" data-number="43.1.3"><h3 data-number="43.1.3" class="anchored" data-anchor-id="sec-evaluation-surdispersion">
<span class="header-section-number">43.1.3</span> Évaluation de la surdispersion</h3>
<p>Comme tous les modèles GLM, le modèle de Poisson présuppose que les observations sont indépendantes les unes des autres<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Surtout, la distribution de Poisson présuppose que la variance est égale à la moyenne. Or, il arrive fréquemment que la variance soit supérieure à la moyenne, auquel cas on parle alors de <strong>surdispersion</strong>. Si c’est le cas, le modèle de Poisson va sous-estimer la variance et produire des intervalles de confiance trop petit et des p-valeurs trop petites.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;Si ce n’était pas le cas, par exemple s’il y a plusieurs observations pour un même individu, il faudrait adopter un autre type de modèle, par exemple un modèle mixte ou un modèle GEE, pour lesquels il est possible d’utiliser une distribution de Poisson.</p></div></div><p>En premier lieu, nous pouvons vérifier si la distribution observée des données correspond peu ou prou à la distribution théorique de Poisson pour une moyenne correspondant à la moyenne observée.</p>
<p>La fonction ci-dessous permet justement de comparer la distribution observée avec la distribution théorique d’un modèle.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>observed_vs_theoretical <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb17-2"><a href="#cb17-2"></a>  observed <span class="ot">&lt;-</span> <span class="fu">model.response</span>(<span class="fu">model.frame</span>(model))</span>
<span id="cb17-3"><a href="#cb17-3"></a>  theoretical <span class="ot">&lt;-</span> <span class="fu">simulate</span>(model, <span class="at">nsim =</span> <span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a>  theoretical <span class="ot">&lt;-</span> theoretical[[<span class="dv">1</span>]]</span>
<span id="cb17-5"><a href="#cb17-5"></a>  df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb17-6"><a href="#cb17-6"></a>    <span class="at">status =</span> <span class="fu">c</span>(</span>
<span id="cb17-7"><a href="#cb17-7"></a>      <span class="fu">rep.int</span>(<span class="st">"observed"</span>, <span class="fu">length</span>(observed)),</span>
<span id="cb17-8"><a href="#cb17-8"></a>      <span class="fu">rep.int</span>(<span class="st">"theoretical"</span>, <span class="fu">length</span>(theoretical))</span>
<span id="cb17-9"><a href="#cb17-9"></a>    ),</span>
<span id="cb17-10"><a href="#cb17-10"></a>    <span class="at">values =</span> <span class="fu">c</span>(observed, theoretical)</span>
<span id="cb17-11"><a href="#cb17-11"></a>  )</span>
<span id="cb17-12"><a href="#cb17-12"></a>  <span class="cf">if</span> (<span class="fu">is.numeric</span>(observed) <span class="sc">&amp;&amp;</span> <span class="fu">any</span>(observed <span class="sc">!=</span> <span class="fu">as.integer</span>(observed))) {</span>
<span id="cb17-13"><a href="#cb17-13"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">fill =</span> status) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(</span>
<span id="cb17-16"><a href="#cb17-16"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb17-17"><a href="#cb17-17"></a>      <span class="at">position =</span> <span class="st">"identity"</span></span>
<span id="cb17-18"><a href="#cb17-18"></a>    ) <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">fill =</span> <span class="cn">NULL</span>)</span>
<span id="cb17-21"><a href="#cb17-21"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-22"><a href="#cb17-22"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb17-23"><a href="#cb17-23"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">fill =</span> status) <span class="sc">+</span></span>
<span id="cb17-24"><a href="#cb17-24"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(</span>
<span id="cb17-25"><a href="#cb17-25"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb17-26"><a href="#cb17-26"></a>      <span class="at">position =</span> <span class="st">"identity"</span></span>
<span id="cb17-27"><a href="#cb17-27"></a>    ) <span class="sc">+</span></span>
<span id="cb17-28"><a href="#cb17-28"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb17-29"><a href="#cb17-29"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb17-30"><a href="#cb17-30"></a>      <span class="at">panel.grid.major.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb17-31"><a href="#cb17-31"></a>      <span class="at">panel.grid.minor.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()</span>
<span id="cb17-32"><a href="#cb17-32"></a>    ) <span class="sc">+</span></span>
<span id="cb17-33"><a href="#cb17-33"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">fill =</span> <span class="cn">NULL</span>)</span>
<span id="cb17-34"><a href="#cb17-34"></a>  }</span>
<span id="cb17-35"><a href="#cb17-35"></a>}</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Appliquons cette fonction à notre modèle de Poisson.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>mod1_poisson <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">observed_vs_theoretical</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-observed-vs-theoritical-mod1-poisson" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-observed-vs-theoritical-mod1-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="modeles-comptage_files/figure-html/fig-observed-vs-theoritical-mod1-poisson-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="quarto-lightbox-gallery-3"><img src="modeles-comptage_files/figure-html/fig-observed-vs-theoritical-mod1-poisson-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-observed-vs-theoritical-mod1-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43.3: Distribution observée vs distribution théorique de la descendance atteinte à 30 ans (modèle de Poisson)
</figcaption></figure>
</div>
</div>
</div>
<p>Les deux distributions restent assez proches même si la distribution observée est légèrement décalée vers la droite.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>La fonction <code><a href="https://easystats.github.io/performance/reference/check_predictions.html">performance::check_predictions()</a></code> propose une visualisation un peu plus avancée.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>mod1_poisson <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>  performance<span class="sc">::</span><span class="fu">check_predictions</span>(<span class="at">type =</span> <span class="st">"discrete_both"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Maximum value of original data is not included in the
  replicated data.
  Model may not capture the variation of the data.</code></pre>
</div>
</div>
<p>Les points verts correspondent au nombre d’individus observés (sur l’axe vertical) pour chaque valeur de notre variable à expliquer (sur l’axe horizontal). La fonction simule ensuite une cinquantaine de jeu de données par réplication et affiche les prédictions du modèle pour ces jeux de données (points bleus avec effet de transparence), ainsi que les prédictions médianes (point bleu sans transparence) et l’intervalle des prédictions (barres verticales).</p>
<p>Dans notre exemple, on voit notamment que le modèle a du mal à prédire correctement le nombre d’individus avec 0, 1 ou 2 enfants.</p>
</div>
</div>
<p>Le paramètre φ (phi) qui correspond au ratio entre la variance observée et la variance théorique peut être estimée, en pratique, selon certains auteurs, comme le ratio de la déviance résiduelle sur le nombre de degrés de libertés du modèle. Il s’obtient ainsi&nbsp;:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>mod1_poisson<span class="sc">$</span>deviance <span class="sc">/</span> mod1_poisson<span class="sc">$</span>df.residual</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8580717</code></pre>
</div>
</div>
<p>Si ce ratio s’écarte de 1, alors il y a un problème de surdispersion. Cependant, en pratique, il n’y a pas de seuil précis à partir duquel nous pourrions conclure qu’il faut rejeter le modèle.</p>
<p>La package <code>{AER}</code> propose un test, <code><a href="https://rdrr.io/pkg/AER/man/dispersiontest.html">AER::dispersiontest()</a></code>, pour tester s’il y a un problème de surdispersion. Ce test ne peut s’appliquer qu’à un modèle de Poisson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>mod1_poisson <span class="sc">|&gt;</span> AER<span class="sc">::</span><span class="fu">dispersiontest</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Overdispersion test

data:  mod1_poisson
z = 3.3367, p-value = 0.0004238
alternative hypothesis: true dispersion is greater than 1
sample estimates:
dispersion 
  1.361364 </code></pre>
</div>
</div>
<p>Le package <a href="https://easystats.github.io/performance/">performance</a> propose, quant à lui, un test plus générale de surdispersion via la fonction <code><a href="https://easystats.github.io/performance/reference/check_overdispersion.html">performance::check_overdispersion()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>mod1_poisson <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2"></a>  performance<span class="sc">::</span><span class="fu">check_overdispersion</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

       dispersion ratio =    1.371
  Pearson's Chi-Squared = 1096.575
                p-value =  &lt; 0.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Overdispersion detected.</code></pre>
</div>
</div>
<p>Dans les deux cas, nous obtenons une p-valeur inférieure à 0,001, indiquant que le modèle de Poisson n’est peut-être pas approprié ici.</p>
</section></section><section id="modèle-de-quasi-poisson" class="level2 page-columns page-full" data-number="43.2"><h2 data-number="43.2" class="anchored" data-anchor-id="modèle-de-quasi-poisson">
<span class="header-section-number">43.2</span> Modèle de quasi-Poisson</h2>
<p>Le modèle de <strong>quasi-Poisson</strong> est similaire au modèle de <strong>Poisson</strong> mais autorise plus de souplesse pour la modélisation de la variance qui est alors modélisée comme une relation linéaire de la moyenne. Il se calcule également avec <code><a href="https://rdrr.io/r/stats/glm.html">stats::glm()</a></code>, mais en indiquant <code>family = quasipoisson</code>. Comme avec le modèle de Poisson, la fonction de lien par défaut est la fonction logarithmique (<em>log</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>mod1_quasi <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb28-2"><a href="#cb28-2"></a>  enfants_avt_30 <span class="sc">~</span> educ2 <span class="sc">+</span> milieu,</span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="at">family =</span> quasipoisson,</span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="at">data =</span> femmes30p</span>
<span id="cb28-5"><a href="#cb28-5"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>L’AIC (<em>Akaike information criterion</em>) n’est pas défini pour ce type de modèle. Il n’est donc pas possible d’utiliser <code><a href="https://rdrr.io/r/stats/step.html">stats::step()</a></code> avec un modèle de quasi-Poisson. Si l’on veut procéder à une sélection pas à pas descendante, on procédera donc en amont avec un modèle de Poisson classique.</p>
</div>
</div>
<p>Regardons les résultats obtenus&nbsp;:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>mod1_quasi <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">tbl_regression</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">bold_labels</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-regression-quasipoisson" class="cell quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-regression-quasipoisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="dihovyxowk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dihovyxowk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dihovyxowk thead, #dihovyxowk tbody, #dihovyxowk tfoot, #dihovyxowk tr, #dihovyxowk td, #dihovyxowk th {
  border-style: none;
}

#dihovyxowk p {
  margin: 0;
  padding: 0;
}

#dihovyxowk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dihovyxowk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dihovyxowk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dihovyxowk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dihovyxowk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dihovyxowk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dihovyxowk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dihovyxowk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dihovyxowk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dihovyxowk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dihovyxowk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dihovyxowk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dihovyxowk .gt_spanner_row {
  border-bottom-style: hidden;
}

#dihovyxowk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dihovyxowk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dihovyxowk .gt_from_md > :first-child {
  margin-top: 0;
}

#dihovyxowk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dihovyxowk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dihovyxowk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dihovyxowk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dihovyxowk .gt_row_group_first td {
  border-top-width: 2px;
}

#dihovyxowk .gt_row_group_first th {
  border-top-width: 2px;
}

#dihovyxowk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dihovyxowk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dihovyxowk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dihovyxowk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dihovyxowk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dihovyxowk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dihovyxowk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dihovyxowk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dihovyxowk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dihovyxowk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dihovyxowk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dihovyxowk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dihovyxowk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dihovyxowk .gt_left {
  text-align: left;
}

#dihovyxowk .gt_center {
  text-align: center;
}

#dihovyxowk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dihovyxowk .gt_font_normal {
  font-weight: normal;
}

#dihovyxowk .gt_font_bold {
  font-weight: bold;
}

#dihovyxowk .gt_font_italic {
  font-style: italic;
}

#dihovyxowk .gt_super {
  font-size: 65%;
}

#dihovyxowk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dihovyxowk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dihovyxowk .gt_indent_1 {
  text-indent: 5px;
}

#dihovyxowk .gt_indent_2 {
  text-indent: 10px;
}

#dihovyxowk .gt_indent_3 {
  text-indent: 15px;
}

#dihovyxowk .gt_indent_4 {
  text-indent: 20px;
}

#dihovyxowk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead><tr class="header gt_col_headings">
<th id="<strong>Caractéristique</strong>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Caractéristique</strong></th>
<th id="<strong>IRR</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>IRR</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
<th id="<strong>95% IC</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>95% IC</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
<th id="<strong>p-valeur</strong>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-valeur</strong></th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Niveau d'éducation</td>
<td class="gt_row gt_center" headers="estimate"><br></td>
<td class="gt_row gt_center" headers="ci"><br></td>
<td class="gt_row gt_center" headers="p.value"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;aucun</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="ci">—</td>
<td class="gt_row gt_center" headers="p.value"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;primaire</td>
<td class="gt_row gt_center" headers="estimate">1,25</td>
<td class="gt_row gt_center" headers="ci">0,85 – 1,81</td>
<td class="gt_row gt_center" headers="p.value">0,2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;secondaire/supérieur</td>
<td class="gt_row gt_center" headers="estimate">0,53</td>
<td class="gt_row gt_center" headers="ci">0,23 – 1,05</td>
<td class="gt_row gt_center" headers="p.value">0,10</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Milieu de résidence</td>
<td class="gt_row gt_center" headers="estimate"><br></td>
<td class="gt_row gt_center" headers="ci"><br></td>
<td class="gt_row gt_center" headers="p.value"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;urbain</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="ci">—</td>
<td class="gt_row gt_center" headers="p.value"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;rural</td>
<td class="gt_row gt_center" headers="estimate">1,42</td>
<td class="gt_row gt_center" headers="ci">0,99 – 2,10</td>
<td class="gt_row gt_center" headers="p.value">0,067</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr class="even">
<td colspan="4" class="gt_footnote">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> IRR = rapport de taux d’incidence, IC = intervalle de confiance</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-regression-quasipoisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;43.2: Tableau des coefficients du modèle de quasi-Poisson
</figcaption></figure>
</div>
</div>
<p>Les coefficients sont identiques à ceux obtenus avec le modèle de Poisson (cf. <a href="#tbl-regression-poisson" class="quarto-xref">Table&nbsp;<span>43.1</span></a>), mais les intervalles de confiance sont plus larges et les p-valeurs plus élevées, traduisant la prise en compte d’une variance plus importante. Cela se voit aisément si l’on compare les coefficients avec <code><a href="https://larmarange.github.io/ggstats/reference/ggcoef_model.html">ggstats::ggcoef_compare()</a></code>.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">list</span>(<span class="at">Poisson =</span> mod1_poisson, <span class="st">"quasi-Poisson"</span> <span class="ot">=</span> mod1_quasi) <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">ggcoef_compare</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-compare-poisson-quasi" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-compare-poisson-quasi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="modeles-comptage_files/figure-html/fig-compare-poisson-quasi-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="quarto-lightbox-gallery-4"><img src="modeles-comptage_files/figure-html/fig-compare-poisson-quasi-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-compare-poisson-quasi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43.4: Comparaison des coefficients du modèle de Poisson et du modèle de quasi-Poisson
</figcaption></figure>
</div>
</div>
</div>
<p>Le passage à un modèle de quasi-Poisson aura-t-il été suffisant pour régler notre problème de surdispersion&nbsp;? La fonction <code><a href="https://easystats.github.io/performance/reference/check_overdispersion.html">performance::check_overdispersion()</a></code> peut être appliquée à un modèle de quasi-Poisson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>mod1_quasi <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>  performance<span class="sc">::</span><span class="fu">check_overdispersion</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

       dispersion ratio =    1.371
  Pearson's Chi-Squared = 1096.575
                p-value =  &lt; 0.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Overdispersion detected.</code></pre>
</div>
</div>
<p>Il semble que nous ayons toujours une surdispersion, insuffisamment corrigée par le modèle de quasi-Poisson.</p>
</section><section id="modèle-binomial-négatif" class="level2 page-columns page-full" data-number="43.3"><h2 data-number="43.3" class="anchored" data-anchor-id="modèle-binomial-négatif">
<span class="header-section-number">43.3</span> Modèle binomial négatif</h2>
<p>Le modèle binomial négatif (<em>negative binomial</em> en anglais) modélise la variance selon une spécification quadratique (i.e.&nbsp;selon le carré de la moyenne). Il est implémenté dans le package <a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a> via la fonction <code><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html">MASS::glm.nb()</a></code>. Les autres paramètres sont identiques à ceux de <code><a href="https://rdrr.io/r/stats/glm.html">stats::glm()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>mod1_nb <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">glm.nb</span>(</span>
<span id="cb34-2"><a href="#cb34-2"></a>  enfants_avt_30 <span class="sc">~</span> educ2 <span class="sc">+</span> milieu <span class="sc">+</span> region,</span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="at">data =</span> femmes30p</span>
<span id="cb34-4"><a href="#cb34-4"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’AIC étant défini pour pour ce type de modèle, nous pouvons procéder à une sélection pas à pas avec <code><a href="https://rdrr.io/r/stats/step.html">stats::step()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>mod1_nb <span class="ot">&lt;-</span> mod1_nb <span class="sc">|&gt;</span> <span class="fu">step</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=979.1
enfants_avt_30 ~ educ2 + milieu + region

         Df Deviance    AIC
- region  3   462.89 975.01
&lt;none&gt;        460.98 979.10
- milieu  1   463.29 979.41
- educ2   2   466.11 980.22

Step:  AIC=975
enfants_avt_30 ~ educ2 + milieu

         Df Deviance    AIC
&lt;none&gt;        460.14 975.00
- milieu  1   463.37 976.24
- educ2   2   465.54 976.40</code></pre>
</div>
</div>
<p>La fonction de lien étant toujours logarithmique, nous pouvons donc afficher plutôt l’exponentielle des coefficients qui s’interprètent comme pour un modèle de Poisson.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>mod1_nb <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">tbl_regression</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="fu">bold_labels</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-regression-nb" class="cell quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><div aria-describedby="tbl-regression-nb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<div id="ralxrvfbqs" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ralxrvfbqs table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ralxrvfbqs thead, #ralxrvfbqs tbody, #ralxrvfbqs tfoot, #ralxrvfbqs tr, #ralxrvfbqs td, #ralxrvfbqs th {
  border-style: none;
}

#ralxrvfbqs p {
  margin: 0;
  padding: 0;
}

#ralxrvfbqs .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ralxrvfbqs .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ralxrvfbqs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ralxrvfbqs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ralxrvfbqs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ralxrvfbqs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ralxrvfbqs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ralxrvfbqs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ralxrvfbqs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ralxrvfbqs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ralxrvfbqs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ralxrvfbqs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ralxrvfbqs .gt_spanner_row {
  border-bottom-style: hidden;
}

#ralxrvfbqs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ralxrvfbqs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ralxrvfbqs .gt_from_md > :first-child {
  margin-top: 0;
}

#ralxrvfbqs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ralxrvfbqs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ralxrvfbqs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ralxrvfbqs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ralxrvfbqs .gt_row_group_first td {
  border-top-width: 2px;
}

#ralxrvfbqs .gt_row_group_first th {
  border-top-width: 2px;
}

#ralxrvfbqs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ralxrvfbqs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ralxrvfbqs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ralxrvfbqs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ralxrvfbqs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ralxrvfbqs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ralxrvfbqs .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ralxrvfbqs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ralxrvfbqs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ralxrvfbqs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ralxrvfbqs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ralxrvfbqs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ralxrvfbqs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ralxrvfbqs .gt_left {
  text-align: left;
}

#ralxrvfbqs .gt_center {
  text-align: center;
}

#ralxrvfbqs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ralxrvfbqs .gt_font_normal {
  font-weight: normal;
}

#ralxrvfbqs .gt_font_bold {
  font-weight: bold;
}

#ralxrvfbqs .gt_font_italic {
  font-style: italic;
}

#ralxrvfbqs .gt_super {
  font-size: 65%;
}

#ralxrvfbqs .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ralxrvfbqs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ralxrvfbqs .gt_indent_1 {
  text-indent: 5px;
}

#ralxrvfbqs .gt_indent_2 {
  text-indent: 10px;
}

#ralxrvfbqs .gt_indent_3 {
  text-indent: 15px;
}

#ralxrvfbqs .gt_indent_4 {
  text-indent: 20px;
}

#ralxrvfbqs .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead><tr class="header gt_col_headings">
<th id="<strong>Caractéristique</strong>" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Caractéristique</strong></th>
<th id="<strong>IRR</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>IRR</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
<th id="<strong>95% IC</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>95% IC</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span>
</th>
<th id="<strong>p-valeur</strong>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-valeur</strong></th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Niveau d'éducation</td>
<td class="gt_row gt_center" headers="estimate"><br></td>
<td class="gt_row gt_center" headers="ci"><br></td>
<td class="gt_row gt_center" headers="p.value"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;aucun</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="ci">—</td>
<td class="gt_row gt_center" headers="p.value"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;primaire</td>
<td class="gt_row gt_center" headers="estimate">1,23</td>
<td class="gt_row gt_center" headers="ci">0,82 – 1,82</td>
<td class="gt_row gt_center" headers="p.value">0,3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;secondaire/supérieur</td>
<td class="gt_row gt_center" headers="estimate">0,53</td>
<td class="gt_row gt_center" headers="ci">0,25 – 1,03</td>
<td class="gt_row gt_center" headers="p.value">0,074</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label" style="font-weight: bold">Milieu de résidence</td>
<td class="gt_row gt_center" headers="estimate"><br></td>
<td class="gt_row gt_center" headers="ci"><br></td>
<td class="gt_row gt_center" headers="p.value"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;urbain</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="ci">—</td>
<td class="gt_row gt_center" headers="p.value"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;rural</td>
<td class="gt_row gt_center" headers="estimate">1,41</td>
<td class="gt_row gt_center" headers="ci">0,97 – 2,06</td>
<td class="gt_row gt_center" headers="p.value">0,076</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr class="even">
<td colspan="4" class="gt_footnote">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> IRR = rapport de taux d’incidence, IC = intervalle de confiance</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-tbl margin-caption" id="tbl-regression-nb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;43.3: Tableau des coefficients du modèle binomial négatif
</figcaption></figure>
</div>
</div>
<p>Cette fois-ci, les coefficients sont légèrement différents par rapport au modèle de Poisson, ce qui se voit aisément si l’on compare les trois modèles.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">list</span>(</span>
<span id="cb38-2"><a href="#cb38-2"></a>  <span class="at">Poisson =</span> mod1_poisson,</span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="st">"quasi-Poisson"</span> <span class="ot">=</span> mod1_quasi,</span>
<span id="cb38-4"><a href="#cb38-4"></a>  <span class="st">"Binomial négatif"</span> <span class="ot">=</span> mod1_nb</span>
<span id="cb38-5"><a href="#cb38-5"></a>) <span class="sc">|&gt;</span></span>
<span id="cb38-6"><a href="#cb38-6"></a>  <span class="fu">ggcoef_compare</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-compare-poisson-quasi-nb" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-compare-poisson-quasi-nb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="modeles-comptage_files/figure-html/fig-compare-poisson-quasi-nb-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-5" data-gallery="quarto-lightbox-gallery-5"><img src="modeles-comptage_files/figure-html/fig-compare-poisson-quasi-nb-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-compare-poisson-quasi-nb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43.5: Comparaison des coefficients du modèle de Poisson, du modèle de quasi-Poisson et du modèle binomial négatif
</figcaption></figure>
</div>
</div>
</div>
<p>Nous pouvons comparer la distribution observée et la distribution théorique et constater que les prédictions sont plus proches des données observées.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>mod1_nb <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="fu">observed_vs_theoretical</span>()</span>
<span id="cb39-3"><a href="#cb39-3"></a>mod1_nb <span class="sc">|&gt;</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>  performance<span class="sc">::</span><span class="fu">check_predictions</span>(<span class="at">type =</span> <span class="st">"discrete_both"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-observed-vs-theoritical-mod1-nb" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-observed-vs-theoritical-mod1-nb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="modeles-comptage_files/figure-html/fig-observed-vs-theoritical-mod1-nb-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="quarto-lightbox-gallery-6"><img src="modeles-comptage_files/figure-html/fig-observed-vs-theoritical-mod1-nb-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-observed-vs-theoritical-mod1-nb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43.6: Distribution observée vs distribution théorique de la descendance atteinte à 30 ans (modèle négatif binomial)
</figcaption></figure>
</div>
</div>
</div>
<p>Nous pouvons vérifier la surdispersion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>mod1_nb <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2"></a>  performance<span class="sc">::</span><span class="fu">check_overdispersion</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

 dispersion ratio = 0.975
          p-value = 0.856</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No overdispersion detected.</code></pre>
</div>
</div>
<p>Ouf&nbsp;! Nous n’avons plus de problème de surdispersion.</p>
<p>Pour celles et ceux intéressé·es, il est possible de comparer la performance des modèles avec la fonction <code><a href="https://easystats.github.io/performance/reference/compare_performance.html">performance::compare_performance()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(</span>
<span id="cb43-2"><a href="#cb43-2"></a>  mod1_poisson,</span>
<span id="cb43-3"><a href="#cb43-3"></a>  mod1_nb,</span>
<span id="cb43-4"><a href="#cb43-4"></a>  <span class="at">metrics =</span> <span class="st">"common"</span></span>
<span id="cb43-5"><a href="#cb43-5"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name         |  Model |  AIC (weights) |  BIC (weights) | Nagelkerke's R2 |  RMSE
---------------------------------------------------------------------------------
mod1_poisson |    glm | 1010.7 (&lt;.001) | 1029.4 (&lt;.001) |           0.033 | 0.579
mod1_nb      | negbin |  977.0 (&gt;.999) | 1000.5 (&gt;.999) |           0.032 | 0.579</code></pre>
</div>
</div>
</section><section id="exemple-avec-une-plus-grande-surdispersion" class="level2 page-columns page-full" data-number="43.4"><h2 data-number="43.4" class="anchored" data-anchor-id="exemple-avec-une-plus-grande-surdispersion">
<span class="header-section-number">43.4</span> Exemple avec une plus grande surdispersion</h2>
<p>Pour ce second exemple, nous allons considérer le jeu de données <code><a href="https://rdrr.io/pkg/MASS/man/quine.html">MASS::quine</a></code> qui contient les données de 146 enfants scolarisés en Australie, notamment le nombre de jours d’absence à l’école au cours de l’année passée, le sexe l’enfant et leur vitesse d’apprentissage (dans la moyenne ou lentement).</p>
<p>Préparons les données en francisant les facteurs et en ajoutant des étiquettes de variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>d <span class="ot">&lt;-</span> MASS<span class="sc">::</span>quine <span class="sc">|&gt;</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-3"><a href="#cb45-3"></a>    <span class="at">jours =</span> Days,</span>
<span id="cb45-4"><a href="#cb45-4"></a>    <span class="at">sexe =</span> Sex <span class="sc">|&gt;</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>      <span class="fu">fct_recode</span>(</span>
<span id="cb45-6"><a href="#cb45-6"></a>        <span class="st">"fille"</span> <span class="ot">=</span> <span class="st">"F"</span>,</span>
<span id="cb45-7"><a href="#cb45-7"></a>        <span class="st">"garçon"</span> <span class="ot">=</span> <span class="st">"M"</span></span>
<span id="cb45-8"><a href="#cb45-8"></a>      ),</span>
<span id="cb45-9"><a href="#cb45-9"></a>    <span class="at">apprentissage =</span> Lrn <span class="sc">|&gt;</span></span>
<span id="cb45-10"><a href="#cb45-10"></a>      <span class="fu">fct_recode</span>(</span>
<span id="cb45-11"><a href="#cb45-11"></a>        <span class="st">"dans la moyenne"</span> <span class="ot">=</span> <span class="st">"AL"</span>,</span>
<span id="cb45-12"><a href="#cb45-12"></a>        <span class="st">"lentement"</span> <span class="ot">=</span> <span class="st">"SL"</span></span>
<span id="cb45-13"><a href="#cb45-13"></a>      )</span>
<span id="cb45-14"><a href="#cb45-14"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb45-15"><a href="#cb45-15"></a>  <span class="fu">set_variable_labels</span>(</span>
<span id="cb45-16"><a href="#cb45-16"></a>    <span class="at">jours =</span> <span class="st">"Nombre de jours d'absence à l'école"</span>,</span>
<span id="cb45-17"><a href="#cb45-17"></a>    <span class="at">sexe =</span> <span class="st">"Sexe de l'enfant"</span>,</span>
<span id="cb45-18"><a href="#cb45-18"></a>    <span class="at">apprentissage =</span> <span class="st">"Vitesse d'apprentissage"</span></span>
<span id="cb45-19"><a href="#cb45-19"></a>  )</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculons notre modèle de Poisson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>mod2_poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb46-2"><a href="#cb46-2"></a>  jours <span class="sc">~</span> sexe <span class="sc">+</span> apprentissage,</span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="at">data =</span> d,</span>
<span id="cb46-4"><a href="#cb46-4"></a>  <span class="at">family =</span> poisson</span>
<span id="cb46-5"><a href="#cb46-5"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Comparons les données observées avec les données prédites.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>mod2_poisson <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2"></a>  <span class="fu">observed_vs_theoretical</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-observed-vs-theoritical-mod2-poisson" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-observed-vs-theoritical-mod2-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="modeles-comptage_files/figure-html/fig-observed-vs-theoritical-mod2-poisson-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-7" data-gallery="quarto-lightbox-gallery-7"><img src="modeles-comptage_files/figure-html/fig-observed-vs-theoritical-mod2-poisson-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-observed-vs-theoritical-mod2-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43.7: Distribution observée vs distribution théorique du nombre de jours d’absence (modèle de Poisson)
</figcaption></figure>
</div>
</div>
</div>
<p>Nous voyons très clairement un décalage des deux distributions. Notre modèle de Poisson n’arrive pas à capturer la variabilité des observations. Faisons le test de surdispersion pour vérifier<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;Il est possible que l’installation du package <a href="http://florianhartig.github.io/DHARMa/">DHARMa</a> soit requise pour la bonne réalisation du test.</p></div></div><div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>mod2_poisson <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2"></a>  performance<span class="sc">::</span><span class="fu">check_overdispersion</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

       dispersion ratio =   15.895
  Pearson's Chi-Squared = 2273.046
                p-value =  &lt; 0.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Overdispersion detected.</code></pre>
</div>
</div>
<p>Calculons un modèle binomial négatif et voyons si cela améliore la situation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>mod2_nb <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">glm.nb</span>(</span>
<span id="cb51-2"><a href="#cb51-2"></a>  jours <span class="sc">~</span> sexe <span class="sc">+</span> apprentissage,</span>
<span id="cb51-3"><a href="#cb51-3"></a>  <span class="at">data =</span> d</span>
<span id="cb51-4"><a href="#cb51-4"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>mod2_nb <span class="sc">|&gt;</span> </span>
<span id="cb52-2"><a href="#cb52-2"></a>  <span class="fu">observed_vs_theoretical</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-observed-vs-theoritical-mod2-nb" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-observed-vs-theoritical-mod2-nb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="modeles-comptage_files/figure-html/fig-observed-vs-theoritical-mod2-nb-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-8" data-gallery="quarto-lightbox-gallery-8"><img src="modeles-comptage_files/figure-html/fig-observed-vs-theoritical-mod2-nb-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-observed-vs-theoritical-mod2-nb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43.8: Distribution observée vs distribution théorique du nombre de jours d’absence (modèle binomial négatif)
</figcaption></figure>
</div>
</div>
</div>
<p>Les deux distributions sont bien plus proches maintenant. Vérifions la surdispersion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>mod2_nb <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2"></a>  performance<span class="sc">::</span><span class="fu">check_overdispersion</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

 dispersion ratio = 0.978
          p-value = 0.992</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No overdispersion detected.</code></pre>
</div>
</div>
<p>Voilà !</p>
<p>Pour finir, visualisons les coefficients du modèle.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>mod2_nb <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a href="#cb56-2"></a>  <span class="fu">ggcoef_table</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-ggcoef_table-mod2_nb" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-ggcoef_table-mod2_nb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="modeles-comptage_files/figure-html/fig-ggcoef_table-mod2_nb-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-9" data-gallery="quarto-lightbox-gallery-9"><img src="modeles-comptage_files/figure-html/fig-ggcoef_table-mod2_nb-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-ggcoef_table-mod2_nb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43.9: Facteurs associés à l’absentéisme scolaire (modèle négatif binomial)
</figcaption></figure>
</div>
</div>
</div>
</section><section id="modèles-de-comptage-avec-une-variable-binaire" class="level2 page-columns page-full" data-number="43.5"><h2 data-number="43.5" class="anchored" data-anchor-id="modèles-de-comptage-avec-une-variable-binaire">
<span class="header-section-number">43.5</span> Modèles de comptage avec une variable binaire</h2>
<p>Pour l’analyse d’une variable binaire, les modèles de comptage représentent une alternative à la régression logistique binaire (cf. <a href="../analyses/regression-logistique-binaire.html" class="quarto-xref"><span>Chapitre 22</span></a>). L’intérêt est de pouvoir interpréter les coefficients comme des <em>prevalence ratio</em> plutôt que des <em>odds ratio</em>.</p>
<p>Reprenons un exemple, que nous avons déjà utilisé à plusieurs reprises, concernant la probabilité de faire du sport, à partir de l’enquête <em>histoires de vie 2003</em>. Commençons par charger et recoder les données.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">data</span>(hdv2003, <span class="at">package =</span> <span class="st">"questionr"</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a></span>
<span id="cb57-3"><a href="#cb57-3"></a>d <span class="ot">&lt;-</span></span>
<span id="cb57-4"><a href="#cb57-4"></a>  hdv2003 <span class="sc">|&gt;</span> </span>
<span id="cb57-5"><a href="#cb57-5"></a>  <span class="fu">mutate</span>(</span>
<span id="cb57-6"><a href="#cb57-6"></a>    <span class="at">groupe_ages =</span> age <span class="sc">|&gt;</span></span>
<span id="cb57-7"><a href="#cb57-7"></a>      <span class="fu">cut</span>(</span>
<span id="cb57-8"><a href="#cb57-8"></a>        <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">25</span>, <span class="dv">45</span>, <span class="dv">65</span>, <span class="dv">99</span>),</span>
<span id="cb57-9"><a href="#cb57-9"></a>        <span class="at">right =</span> <span class="cn">FALSE</span>,</span>
<span id="cb57-10"><a href="#cb57-10"></a>        <span class="at">include.lowest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb57-11"><a href="#cb57-11"></a>        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"18-24 ans"</span>, <span class="st">"25-44 ans"</span>,</span>
<span id="cb57-12"><a href="#cb57-12"></a>                   <span class="st">"45-64 ans"</span>, <span class="st">"65 ans et plus"</span>)</span>
<span id="cb57-13"><a href="#cb57-13"></a>      )</span>
<span id="cb57-14"><a href="#cb57-14"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb57-15"><a href="#cb57-15"></a>  <span class="fu">set_variable_labels</span>(</span>
<span id="cb57-16"><a href="#cb57-16"></a>    <span class="at">sport =</span> <span class="st">"Pratique un sport ?"</span>,</span>
<span id="cb57-17"><a href="#cb57-17"></a>    <span class="at">sexe =</span> <span class="st">"Sexe"</span>,</span>
<span id="cb57-18"><a href="#cb57-18"></a>    <span class="at">groupe_ages =</span> <span class="st">"Groupe d'âges"</span>,</span>
<span id="cb57-19"><a href="#cb57-19"></a>    <span class="at">heures.tv =</span> <span class="st">"Heures de télévision / jour"</span></span>
<span id="cb57-20"><a href="#cb57-20"></a>  )</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pour la variable <em>sexe</em>, nous allons définir la modalité <q>Femme</q> comme modalité de référence. Pour cela, nous allons utiliser un contraste personnalisé (cf. <a href="../analyses/contrastes.html" class="quarto-xref"><span>Chapitre 25</span></a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">levels</span>(d<span class="sc">$</span>sexe)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Homme" "Femme"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">contrasts</span>(d<span class="sc">$</span>sexe) <span class="ot">&lt;-</span> <span class="fu">contr.treatment</span>(<span class="dv">2</span>, <span class="at">base =</span> <span class="dv">2</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculons le modèle de régression logistique binaire classique.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>mod3_binomial <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb61-2"><a href="#cb61-2"></a>  sport <span class="sc">~</span> sexe <span class="sc">+</span> groupe_ages <span class="sc">+</span> heures.tv,</span>
<span id="cb61-3"><a href="#cb61-3"></a>  <span class="at">family =</span> binomial,</span>
<span id="cb61-4"><a href="#cb61-4"></a>  <span class="at">data =</span> d</span>
<span id="cb61-5"><a href="#cb61-5"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nous allons maintenant calculer un modèle de Poisson. Nous devons déjà ré-exprimer notre variable à expliquer sous la forme d’une variable numérique égale à 0 si l’on ne pratique pas de sport et à 1 si l’on pratique un sport.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">levels</span>(d<span class="sc">$</span>sport)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Non" "Oui"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>d<span class="sc">$</span>sport2 <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(d<span class="sc">$</span>sport <span class="sc">==</span> <span class="st">"Oui"</span>)</span>
<span id="cb64-2"><a href="#cb64-2"></a>mod3_poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb64-3"><a href="#cb64-3"></a>  sport2 <span class="sc">~</span> sexe <span class="sc">+</span> groupe_ages <span class="sc">+</span> heures.tv,</span>
<span id="cb64-4"><a href="#cb64-4"></a>  <span class="at">family =</span> poisson,</span>
<span id="cb64-5"><a href="#cb64-5"></a>  <span class="at">data =</span> d</span>
<span id="cb64-6"><a href="#cb64-6"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vérifions si nous avons un problème de surdispersion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>performance<span class="sc">::</span><span class="fu">check_overdispersion</span>(mod3_poisson)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

       dispersion ratio =    0.635
  Pearson's Chi-Squared = 1263.552
                p-value =        1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No overdispersion detected.</code></pre>
</div>
</div>
<p>Regardons maintenant les résultats de nos deux modèles.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>mod3_binomial <span class="sc">|&gt;</span> </span>
<span id="cb68-2"><a href="#cb68-2"></a>  ggstats<span class="sc">::</span><span class="fu">ggcoef_table</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-mod3-binomial" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-mod3-binomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="modeles-comptage_files/figure-html/fig-mod3-binomial-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-10" data-gallery="quarto-lightbox-gallery-10"><img src="modeles-comptage_files/figure-html/fig-mod3-binomial-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-mod3-binomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43.10: Facteurs associés à la pratique d’un sport (régression logistique)
</figcaption></figure>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>mod3_poisson <span class="sc">|&gt;</span> </span>
<span id="cb69-2"><a href="#cb69-2"></a>  ggstats<span class="sc">::</span><span class="fu">ggcoef_table</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-mod3-poisson" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-mod3-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="modeles-comptage_files/figure-html/fig-mod3-poisson-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-11" data-gallery="quarto-lightbox-gallery-11"><img src="modeles-comptage_files/figure-html/fig-mod3-poisson-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-mod3-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43.11: Facteurs associés à la pratique d’un sport (régression de Poisson)
</figcaption></figure>
</div>
</div>
</div>
<p>Nous pouvons voir ici que les deux modèles fournissent des résultats assez proches. Par contre, les coefficients ne s’interprètent pas de la même manière. Dans le cadre de la régression logistique, il s’agit d’<em>odds ratios</em> (ou rapports des côtes) définis comme <span class="math inline">\(OR_{A/B}=(\frac{p_A}{1-p_A})/(\frac{p_B}{1-p_B})\)</span> où <span class="math inline">\(p_A\)</span> correspond à la probabilité de faire du sport pour la modalité <span class="math inline">\(A\)</span>. Pour la régression de Poisson, il s’agit de <em>prevalence ratios</em> (rapports des prévalences) définis comme <span class="math inline">\(PR_{A/B}=p_A/p_B\)</span>. Avec un rapport des prévalences de 1,3, nous pouvons donc dire que, selon le modèle, les hommes ont 30% de chance en plus de pratiquer un sport.</p>
<p>Pour mieux comparer les deux modèles, nous pouvons présenter les résultats sous la forme de contrastes marginaux moyens (cf. <a href="../analyses/estimations-marginales.html#sec-contrastes-marginaux" class="quarto-xref"><span>Section 24.4</span></a>) qui, pour rappel, sont exprimés dans l’échelle de la variable d’intérêt, soit ici sous la forme d’une différence de probabilité.</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="fu">list</span>(</span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="st">"régression logistique"</span> <span class="ot">=</span> mod3_binomial,</span>
<span id="cb70-3"><a href="#cb70-3"></a>  <span class="st">"régression de Poisson"</span> <span class="ot">=</span> mod3_poisson</span>
<span id="cb70-4"><a href="#cb70-4"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb70-5"><a href="#cb70-5"></a>  <span class="fu">ggcoef_compare</span>(<span class="at">tidy_fun =</span> broom.helpers<span class="sc">::</span>tidy_marginal_contrasts) <span class="sc">+</span></span>
<span id="cb70-6"><a href="#cb70-6"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-mod3-comparaison-contrastes-marginaux" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-mod3-comparaison-contrastes-marginaux-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="modeles-comptage_files/figure-html/fig-mod3-comparaison-contrastes-marginaux-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-12" data-gallery="quarto-lightbox-gallery-12"><img src="modeles-comptage_files/figure-html/fig-mod3-comparaison-contrastes-marginaux-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-mod3-comparaison-contrastes-marginaux-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;43.12: Comparaison des contrastes marginaux des deux modèles
</figcaption></figure>
</div>
</div>
</div>
<p>Les résultats sont ici très proches. Nous pouvons néanmoins constater que les intervalles de confiance pour la régression de Poisson sont un peu plus large. Nous pouvons comparer les deux modèles avec <code><a href="https://easystats.github.io/performance/reference/compare_performance.html">performance::compare_performance()</a></code> pour constater que, dans notre exemple, la régression de Poisson est un peu moins bien ajustée aux données que la régression logistique binaire. Cependant, en pratique, cela n’est pas ici problématique&nbsp;: le choix entre les deux modèles peut donc se faire en fonction de la manière dont on souhaite présenter et narrer les résultats.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>performance<span class="sc">::</span><span class="fu">compare_performance</span>(</span>
<span id="cb71-2"><a href="#cb71-2"></a>  mod3_binomial,</span>
<span id="cb71-3"><a href="#cb71-3"></a>  mod3_poisson,</span>
<span id="cb71-4"><a href="#cb71-4"></a>  <span class="at">metrics =</span> <span class="st">"common"</span></span>
<span id="cb71-5"><a href="#cb71-5"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: contrasts dropped from factor sexe
Warning: contrasts dropped from factor sexe
Warning: contrasts dropped from factor sexe
Warning: contrasts dropped from factor sexe</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name          | Model |  AIC (weights) |  BIC (weights) |  RMSE | Tjur's R2 | Nagelkerke's R2
---------------------------------------------------------------------------------------------
mod3_binomial |   glm | 2346.3 (&gt;.999) | 2379.8 (&gt;.999) | 0.447 |     0.132 |                
mod3_poisson  |   glm | 2748.8 (&lt;.001) | 2782.4 (&lt;.001) | 0.447 |           |           0.158</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Astuce
</div>
</div>
<div class="callout-body-container callout-body">
<p>Lorsque l’on a une variable binaire à expliquer et que l’on souhaite calculer des risques relatifs (RR) ou <em>prevalence ratio</em> (PR), une alternative au modèle de Poisson est le modèle log-binomial. Il s’agit d’un modèle binomial avec une fonction de lien logarithme.</p>
<p>Il faut noter que ce type de modèles a parfois du mal à converger.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>mod3_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb74-2"><a href="#cb74-2"></a>  sport <span class="sc">~</span> sexe <span class="sc">+</span> groupe_ages <span class="sc">+</span> heures.tv,</span>
<span id="cb74-3"><a href="#cb74-3"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb74-4"><a href="#cb74-4"></a>  <span class="at">data =</span> d</span>
<span id="cb74-5"><a href="#cb74-5"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: impossible de trouver un jeu de coefficients correct : prière de fournir des valeurs initiales</code></pre>
</div>
</div>
<p>C’est le cas ici&nbsp;! Nous allons donc initier le modèle avec les coefficients du modèle de Poisson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>mod3_log <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb76-2"><a href="#cb76-2"></a>  sport <span class="sc">~</span> sexe <span class="sc">+</span> groupe_ages <span class="sc">+</span> heures.tv,</span>
<span id="cb76-3"><a href="#cb76-3"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb76-4"><a href="#cb76-4"></a>  <span class="at">start =</span> mod3_poisson<span class="sc">$</span>coefficients,</span>
<span id="cb76-5"><a href="#cb76-5"></a>  <span class="at">data =</span> d</span>
<span id="cb76-6"><a href="#cb76-6"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Regardons les résultats.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>mod3_log <span class="sc">|&gt;</span></span>
<span id="cb77-2"><a href="#cb77-2"></a>  ggstats<span class="sc">::</span><span class="fu">ggcoef_table</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le pas a été tronqué à cause de la divergence
Warning: le pas a été tronqué à cause de la divergence</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit : l'algorithme n'a pas convergé
Warning: glm.fit : l'algorithme n'a pas convergé</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le pas a été tronqué à cause de la divergence</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit : l'algorithme n'a pas convergé</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="modeles-comptage_files/figure-html/unnamed-chunk-51-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="modeles-comptage_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Nous obtenons des résultats assez proches de ceux du modèle de Poisson. Notons cependant les différents avis affichés qui nous indiquent que le modèle a eu des difficultés à converger<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<p>Le package <a href="https://github.com/mdonoghoe/logbin">logbin</a> propose, via <code>login::logbin()</code>, une implémentation de la régression log-binomiale en proposant des algorithmes de convergence plus stables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>mod3_logbin <span class="ot">&lt;-</span> logbin<span class="sc">::</span><span class="fu">logbin</span>(</span>
<span id="cb82-2"><a href="#cb82-2"></a>  sport <span class="sc">~</span> sexe <span class="sc">+</span> groupe_ages <span class="sc">+</span> heures.tv,</span>
<span id="cb82-3"><a href="#cb82-3"></a>  <span class="at">data =</span> d</span>
<span id="cb82-4"><a href="#cb82-4"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Les résultats sont très proches.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>mod3_logbin <span class="sc">|&gt;</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>  ggstats<span class="sc">::</span><span class="fu">ggcoef_table</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `tidy()` method for objects of class `logbin` is not maintained by the broom team, and is only supported through the `glm` tidier method. Please be cautious in interpreting and reporting broom output.

This warning is displayed once per session.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="modeles-comptage_files/figure-html/unnamed-chunk-53-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="modeles-comptage_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;Sur ce sujet, on pourra consulter l’article <em>Log-binomial models: exploring failed convergence</em> par Tyler Williamson, Misha Eliasziw et Gordon Hilton Fick, DOI: <a href="https://doi.org/10.1186/1742-7622-10-14">10.1186/1742-7622-10-14</a>. On pourra également consulter cet échange sur <a href="https://stats.stackexchange.com/a/321407">StackExchange</a>.</p></div></div></section><section id="données-pondérées-et-plan-déchantillonnage" class="level2 page-columns page-full" data-number="43.6"><h2 data-number="43.6" class="anchored" data-anchor-id="données-pondérées-et-plan-déchantillonnage">
<span class="header-section-number">43.6</span> Données pondérées et plan d’échantillonnage</h2>
<p>Lorsque l’on a des données pondérées avec prise en compte d’un plan d’échantillonnage (cf. <a href="../donnees_ponderees/plan-echantillonnage.html" class="quarto-xref"><span>Chapitre 28</span></a>), on ne peut utiliser directement <code><a href="https://rdrr.io/r/stats/glm.html">stats::glm()</a></code> avec un objet <a href="http://r-survey.r-forge.r-project.org/survey/">survey</a>. On aura alors recours à <code><a href="https://rdrr.io/pkg/survey/man/svyglm.html">survey::svyglm()</a></code> qui est très similaire.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="fu">library</span>(srvyr)</span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="fu">library</span>(survey)</span>
<span id="cb85-3"><a href="#cb85-3"></a>dp <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span> </span>
<span id="cb85-4"><a href="#cb85-4"></a>  <span class="fu">as_survey_design</span>(<span class="at">weights =</span> poids)</span>
<span id="cb85-5"><a href="#cb85-5"></a>mod4_poisson <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb85-6"><a href="#cb85-6"></a>  sport2 <span class="sc">~</span> sexe <span class="sc">+</span> groupe_ages <span class="sc">+</span> heures.tv,</span>
<span id="cb85-7"><a href="#cb85-7"></a>  <span class="at">family =</span> poisson,</span>
<span id="cb85-8"><a href="#cb85-8"></a>  <span class="at">design =</span> dp</span>
<span id="cb85-9"><a href="#cb85-9"></a>)</span>
<span id="cb85-10"><a href="#cb85-10"></a>mod4_quasi <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb85-11"><a href="#cb85-11"></a>  sport2 <span class="sc">~</span> sexe <span class="sc">+</span> groupe_ages <span class="sc">+</span> heures.tv,</span>
<span id="cb85-12"><a href="#cb85-12"></a>  <span class="at">family =</span> quasipoisson,</span>
<span id="cb85-13"><a href="#cb85-13"></a>  <span class="at">design =</span> dp</span>
<span id="cb85-14"><a href="#cb85-14"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il est tout à fait possible d’appliquer <code><a href="https://rdrr.io/r/stats/step.html">stats::step()</a></code> à ces modèles<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;Y compris, dans le cas présent, au modèle de quasi-Poisson.</p></div></div><p>Concernant la régression binomiale négative, il n’y a pas d’implémentation fournie directement par <a href="http://r-survey.r-forge.r-project.org/survey/">survey</a>. Cependant, le package <a href="https://strengejacke.github.io/sjstats/">sjstats</a> en propose une via la fonction <code><a href="https://strengejacke.github.io/sjstats/reference/svyglm.nb.html">sjstats::svyglm.nb()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>mod4_nb <span class="ot">&lt;-</span> sjstats<span class="sc">::</span><span class="fu">svyglm.nb</span>(</span>
<span id="cb86-2"><a href="#cb86-2"></a>  sport2 <span class="sc">~</span> sexe <span class="sc">+</span> groupe_ages <span class="sc">+</span> heures.tv,</span>
<span id="cb86-3"><a href="#cb86-3"></a>  <span class="at">design =</span> dp</span>
<span id="cb86-4"><a href="#cb86-4"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : nombre limite d'iterations atteint
Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
control$trace &gt; : nombre limite d'iterations atteint</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Une alternative possible consiste à utiliser des poids de réplication selon une approche du type <em>bootsrap</em>. Il faudra déjà définir des poids de réplication avec <code><a href="http://gdfe.co/srvyr/reference/as_survey_rep.html">srvyr::as_survey_rep()</a></code> puis avoir recours à <code><a href="https://rdrr.io/pkg/survey/man/withReplicates.html">survey::withReplicates()</a></code>. Pour faciliter cette deuxième étape, on pourra se faciliter la vie avec le package <code>{svrepmisc}</code> et sa fonction <code>svrepmisc::svynb()</code>. Ce package n’étant pas disponible sur CRAN, on devra l’installer avec la commande <code>remotes::install_github("carlganz/svrepmisc")</code>.</p>
<p><strong>Attention&nbsp;:</strong> le temps de calcul du modèle avec les poids de réplication est de plusieurs minutes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>dp_rep <span class="ot">&lt;-</span> dp <span class="sc">|&gt;</span> </span>
<span id="cb88-2"><a href="#cb88-2"></a>  <span class="fu">as_survey_rep</span>(<span class="at">type =</span> <span class="st">"bootstrap"</span>, <span class="at">replicates =</span> <span class="dv">100</span>)</span>
<span id="cb88-3"><a href="#cb88-3"></a>mod4_nb_alt <span class="ot">&lt;-</span> svrepmisc<span class="sc">::</span><span class="fu">svynb</span>(</span>
<span id="cb88-4"><a href="#cb88-4"></a>  sport2 <span class="sc">~</span> sexe <span class="sc">+</span> groupe_ages <span class="sc">+</span> heures.tv,</span>
<span id="cb88-5"><a href="#cb88-5"></a>  <span class="at">design =</span> dp_rep</span>
<span id="cb88-6"><a href="#cb88-6"></a>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section><section id="lectures-complémentaires" class="level2" data-number="43.7"><h2 data-number="43.7" class="anchored" data-anchor-id="lectures-complémentaires">
<span class="header-section-number">43.7</span> Lectures complémentaires</h2>
<ul>
<li><p><a href="https://delladata.fr/tutoriel-glm-sur-donnees-de-comptage-regression-de-poisson-avec-r/"><em>Tutoriel : GLM sur données de comptage (régression de Poisson) avec R</em></a> par Claire Della Vedova</p></li>
<li><p><a href="https://www.dataquest.io/blog/tutorial-poisson-regression-in-r/"><em>Tutorial: Poisson Regression in R</em></a> (en anglais) par Hafsa Jabeen</p></li>
<li><p><a href="https://doi.org/10.1890/07-0043.1"><em>Quasi-Poisson vs.&nbsp;negative binomial regression: how should we model overdispersed count data?</em></a> par Jay M Ver Hoef et Peter L Boveng, <em>Ecology</em>. 2007 Nov; 88(11):2766-72. doi: <a href="https://doi.org/10.1890/07-0043.1">10.1890/07-0043.1</a>. PMID: <a href="https://pubmed.ncbi.nlm.nih.gov/18051645/">18051645</a></p></li>
</ul>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Figure&nbsp;43.1: Forest plot des coefficients du modèle de Poisson</span>
<span class="glightbox-desc lightbox-desc-2">Figure&nbsp;43.2: Prédictions marginales du modèle de Poisson</span>
<span class="glightbox-desc lightbox-desc-3">Figure&nbsp;43.3: Distribution observée vs distribution théorique de la descendance atteinte à 30 ans (modèle de Poisson)</span>
<span class="glightbox-desc lightbox-desc-4">Figure&nbsp;43.4: Comparaison des coefficients du modèle de Poisson et du modèle de quasi-Poisson</span>
<span class="glightbox-desc lightbox-desc-5">Figure&nbsp;43.5: Comparaison des coefficients du modèle de Poisson, du modèle de quasi-Poisson et du modèle binomial négatif</span>
<span class="glightbox-desc lightbox-desc-6">Figure&nbsp;43.6: Distribution observée vs distribution théorique de la descendance atteinte à 30 ans (modèle négatif binomial)</span>
<span class="glightbox-desc lightbox-desc-7">Figure&nbsp;43.7: Distribution observée vs distribution théorique du nombre de jours d’absence (modèle de Poisson)</span>
<span class="glightbox-desc lightbox-desc-8">Figure&nbsp;43.8: Distribution observée vs distribution théorique du nombre de jours d’absence (modèle binomial négatif)</span>
<span class="glightbox-desc lightbox-desc-9">Figure&nbsp;43.9: Facteurs associés à l’absentéisme scolaire (modèle négatif binomial)</span>
<span class="glightbox-desc lightbox-desc-10">Figure&nbsp;43.10: Facteurs associés à la pratique d’un sport (régression logistique)</span>
<span class="glightbox-desc lightbox-desc-11">Figure&nbsp;43.11: Facteurs associés à la pratique d’un sport (régression de Poisson)</span>
<span class="glightbox-desc lightbox-desc-12">Figure&nbsp;43.12: Comparaison des contrastes marginaux des deux modèles</span>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="larmarange/guide-R" data-repo-id="R_kgDOH6-xnw" data-category="Forum" data-category-id="DIC_kwDOH6-xn84CRLQy" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="fr" crossorigin="anonymous" data-loading="lazy" async="">
</script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../analyses_avancees/regression-logistique-ordinale.html" class="pagination-link" aria-label="Régression logistique ordinale">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Régression logistique ordinale</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../analyses_avancees/modeles-incidence.html" class="pagination-link" aria-label="Modèles d'incidence / de taux">
        <span class="nav-page-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Modèles d’incidence / de taux</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
 guide-R : Guide pour l'analyse de données d'enquêtes avec R
  </li>  
</ul>
</div>   
    <div class="nav-footer-center">

<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/larmarange/guide-R/blob/main/analyses_avancees/modeles-comptage.qmd" class="toc-action"><i class="bi bi-github"></i>Voir la source</a></li><li><a href="https://github.com/larmarange/guide-R/issues/new" class="toc-action"><i class="bi empty"></i>Faire part d'un problème</a></li></ul></div><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
      <i class="bi bi-badge-cc-fill" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/larmarange/guide-R/" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/c/webinR">
      <i class="bi bi-youtube" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://larmarange.github.io/analyse-R/">
<p>analyse-R</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://larmarange.github.io/webin-R/">
<p>webin-R</p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"descPosition":"bottom","closeEffect":"zoom","loop":false,"selector":".lightbox","openEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>


<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>